{
  "instance_id": "django__django-12700",
  "query": "Settings are cleaned insufficiently.\nDescription\n\t\nPosting publicly after checking with the rest of the security team.\nI just ran into a case where django.views.debug.SafeExceptionReporterFilter.get_safe_settings() would return several un-cleansed values. Looking at cleanse_setting() I realized that we ​only take care of `dict`s but don't take other types of iterables into account but ​return them as-is.\nExample:\nIn my settings.py I have this:\nMY_SETTING = {\n\t\"foo\": \"value\",\n\t\"secret\": \"value\",\n\t\"token\": \"value\",\n\t\"something\": [\n\t\t{\"foo\": \"value\"},\n\t\t{\"secret\": \"value\"},\n\t\t{\"token\": \"value\"},\n\t],\n\t\"else\": [\n\t\t[\n\t\t\t{\"foo\": \"value\"},\n\t\t\t{\"secret\": \"value\"},\n\t\t\t{\"token\": \"value\"},\n\t\t],\n\t\t[\n\t\t\t{\"foo\": \"value\"},\n\t\t\t{\"secret\": \"value\"},\n\t\t\t{\"token\": \"value\"},\n\t\t],\n\t]\n}\nOn Django 3.0 and below:\n>>> import pprint\n>>> from django.views.debug import get_safe_settings\n>>> pprint.pprint(get_safe_settings()[\"MY_SETTING\"])\n{'else': [[{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}],\n\t\t [{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}]],\n 'foo': 'value',\n 'secret': '********************',\n 'something': [{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}],\n 'token': '********************'}\nOn Django 3.1 and up:\n>>> from django.views.debug import SafeExceptionReporterFilter\n>>> import pprint\n>>> pprint.pprint(SafeExceptionReporterFilter().get_safe_settings()[\"MY_SETTING\"])\n{'else': [[{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}],\n\t\t [{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}]],\n 'foo': 'value',\n 'secret': '********************',\n 'something': [{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}],\n 'token': '********************'}\n",
  "ground_truth": {
    "files": [
      "django/views/debug.py"
    ],
    "locations": [
      "django/views/debug.py::SafeExceptionReporterFilter",
      "django/views/debug.py::SafeExceptionReporterFilter.cleanse_setting"
    ]
  },
  "predictions": [
    "django/db/backends/mysql/introspection.py::DatabaseIntrospection._parse_constraint_columns",
    "tests/csrf_tests/tests.py::CsrfViewMiddlewareTests.test_bare_secret_accepted_and_replaced",
    "django/templatetags/i18n.py::do_block_translate",
    "django/views/debug.py::SafeExceptionReporterFilter.cleanse_setting",
    "django/db/backends/sqlite3/introspection.py::DatabaseIntrospection._parse_column_or_constraint_definition",
    "tests/utils_tests/test_crypto.py::TestUtilsCryptoMisc.test_salted_hmac",
    "django/template/defaultfilters.py::pprint",
    "tests/utils_tests/test_html.py::TestUtilsHtml.test_urlize_unchanged_inputs",
    "tests/csrf_tests/tests.py::CsrfViewMiddlewareTests.test_process_view_token_invalid_chars",
    "django/utils/crypto.py::salted_hmac"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "d51c50d836c5cf8db5566da17963f871be554615",
    "total_functions_indexed": 23430,
    "retrieval_time_seconds": 1.5184319019317627
  },
  "raw_output": "[{\"doc_id\": \"django/db/backends/mysql/introspection.py::DatabaseIntrospection._parse_constraint_columns\", \"score\": 275.26463462022815}, {\"doc_id\": \"tests/csrf_tests/tests.py::CsrfViewMiddlewareTests.test_bare_secret_accepted_and_replaced\", \"score\": 255.77730882141427}, {\"doc_id\": \"django/templatetags/i18n.py::do_block_translate\", \"score\": 252.19052230656115}, {\"doc_id\": \"django/views/debug.py::SafeExceptionReporterFilter.cleanse_setting\", \"score\": 247.709612992026}, {\"doc_id\": \"django/db/backends/sqlite3/introspection.py::DatabaseIntrospection._parse_column_or_constraint_definition\", \"score\": 246.9840647759784}, {\"doc_id\": \"tests/utils_tests/test_crypto.py::TestUtilsCryptoMisc.test_salted_hmac\", \"score\": 243.11250739733967}, {\"doc_id\": \"django/template/defaultfilters.py::pprint\", \"score\": 237.90466572425765}, {\"doc_id\": \"tests/utils_tests/test_html.py::TestUtilsHtml.test_urlize_unchanged_inputs\", \"score\": 236.26716005052123}, {\"doc_id\": \"tests/csrf_tests/tests.py::CsrfViewMiddlewareTests.test_process_view_token_invalid_chars\", \"score\": 230.15513805224924}, {\"doc_id\": \"django/utils/crypto.py::salted_hmac\", \"score\": 228.91720492072628}]"
}