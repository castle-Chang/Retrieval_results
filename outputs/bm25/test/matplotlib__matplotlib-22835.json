{
  "instance_id": "matplotlib__matplotlib-22835",
  "query": "[Bug]: scalar mappable format_cursor_data crashes on BoundarNorm\n### Bug summary\r\n\r\nIn 3.5.0 if you do:\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nimport matplotlib as mpl\r\n\r\nfig, ax = plt.subplots()\r\nnorm = mpl.colors.BoundaryNorm(np.linspace(-4, 4, 5), 256)\r\nX = np.random.randn(10, 10)\r\npc = ax.imshow(X, cmap='RdBu_r', norm=norm)\r\n```\r\n\r\nand mouse over the image, it crashes with\r\n\r\n```\r\nFile \"/Users/jklymak/matplotlib/lib/matplotlib/artist.py\", line 1282, in format_cursor_data\r\n    neighbors = self.norm.inverse(\r\n  File \"/Users/jklymak/matplotlib/lib/matplotlib/colors.py\", line 1829, in inverse\r\n    raise ValueError(\"BoundaryNorm is not invertible\")\r\nValueError: BoundaryNorm is not invertible\r\n```\r\n\r\nand interaction stops.  \r\n\r\nNot sure if we should have a special check here, a try-except, or actually just make BoundaryNorm approximately invertible.  \r\n\r\n\r\n### Matplotlib Version\r\n\r\nmain 3.5.0\r\n\r\n\n[Bug]: scalar mappable format_cursor_data crashes on BoundarNorm\n### Bug summary\r\n\r\nIn 3.5.0 if you do:\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nimport matplotlib as mpl\r\n\r\nfig, ax = plt.subplots()\r\nnorm = mpl.colors.BoundaryNorm(np.linspace(-4, 4, 5), 256)\r\nX = np.random.randn(10, 10)\r\npc = ax.imshow(X, cmap='RdBu_r', norm=norm)\r\n```\r\n\r\nand mouse over the image, it crashes with\r\n\r\n```\r\nFile \"/Users/jklymak/matplotlib/lib/matplotlib/artist.py\", line 1282, in format_cursor_data\r\n    neighbors = self.norm.inverse(\r\n  File \"/Users/jklymak/matplotlib/lib/matplotlib/colors.py\", line 1829, in inverse\r\n    raise ValueError(\"BoundaryNorm is not invertible\")\r\nValueError: BoundaryNorm is not invertible\r\n```\r\n\r\nand interaction stops.  \r\n\r\nNot sure if we should have a special check here, a try-except, or actually just make BoundaryNorm approximately invertible.  \r\n\r\n\r\n### Matplotlib Version\r\n\r\nmain 3.5.0\r\n\r\n\n",
  "ground_truth": {
    "files": [
      "lib/matplotlib/artist.py"
    ],
    "locations": [
      "lib/matplotlib/artist.py::Artist",
      "lib/matplotlib/artist.py::Artist.format_cursor_data"
    ]
  },
  "predictions": [
    "lib/matplotlib/colors.py::BoundaryNorm.inverse",
    "lib/matplotlib/tests/test_image.py::test_mask_image_over_under",
    "lib/matplotlib/tests/test_colors.py::test_boundarynorm_and_colorbarbase",
    "lib/matplotlib/tests/test_colorbar.py::test_negative_boundarynorm",
    "lib/matplotlib/colorbar.py::Colorbar._process_values",
    "lib/matplotlib/colorbar.py::Colorbar._mesh",
    "lib/matplotlib/artist.py::Artist.format_cursor_data",
    "lib/matplotlib/tests/test_axes.py::test_imshow_norm_vminvmax",
    "lib/matplotlib/cm.py::ScalarMappable.to_rgba",
    "lib/matplotlib/tests/test_colors.py::test_BoundaryNorm"
  ],
  "metadata": {
    "repo": "matplotlib/matplotlib",
    "commit": "c33557d120eefe3148ebfcf2e758ff2357966000",
    "total_functions_indexed": 8926,
    "retrieval_time_seconds": 0.7682781219482422
  },
  "raw_output": "[{\"doc_id\": \"lib/matplotlib/colors.py::BoundaryNorm.inverse\", \"score\": 279.0670904384218}, {\"doc_id\": \"lib/matplotlib/tests/test_image.py::test_mask_image_over_under\", \"score\": 238.7694424203018}, {\"doc_id\": \"lib/matplotlib/tests/test_colors.py::test_boundarynorm_and_colorbarbase\", \"score\": 223.7152339494533}, {\"doc_id\": \"lib/matplotlib/tests/test_colorbar.py::test_negative_boundarynorm\", \"score\": 221.57102696594032}, {\"doc_id\": \"lib/matplotlib/colorbar.py::Colorbar._process_values\", \"score\": 214.40164173620514}, {\"doc_id\": \"lib/matplotlib/colorbar.py::Colorbar._mesh\", \"score\": 214.0557558423585}, {\"doc_id\": \"lib/matplotlib/artist.py::Artist.format_cursor_data\", \"score\": 213.5725863326336}, {\"doc_id\": \"lib/matplotlib/tests/test_axes.py::test_imshow_norm_vminvmax\", \"score\": 210.37187451350812}, {\"doc_id\": \"lib/matplotlib/cm.py::ScalarMappable.to_rgba\", \"score\": 209.5423165616879}, {\"doc_id\": \"lib/matplotlib/tests/test_colors.py::test_BoundaryNorm\", \"score\": 207.65535106279398}]"
}