{
  "instance_id": "django__django-11910",
  "query": "ForeignKey's to_field parameter gets the old field's name when renaming a PrimaryKey.\nDescription\n\t\nHaving these two models \nclass ModelA(models.Model):\n\tfield_wrong = models.CharField('field1', max_length=50, primary_key=True) # I'm a Primary key.\nclass ModelB(models.Model):\n\tfield_fk = models.ForeignKey(ModelA, blank=True, null=True, on_delete=models.CASCADE) \n... migrations applyed ...\nthe ModelA.field_wrong field has been renamed ... and Django recognizes the \"renaming\"\n# Primary key renamed\nclass ModelA(models.Model):\n\tfield_fixed = models.CharField('field1', max_length=50, primary_key=True) # I'm a Primary key.\nAttempts to to_field parameter. \nThe to_field points to the old_name (field_typo) and not to the new one (\"field_fixed\")\nclass Migration(migrations.Migration):\n\tdependencies = [\n\t\t('app1', '0001_initial'),\n\t]\n\toperations = [\n\t\tmigrations.RenameField(\n\t\t\tmodel_name='modela',\n\t\t\told_name='field_wrong',\n\t\t\tnew_name='field_fixed',\n\t\t),\n\t\tmigrations.AlterField(\n\t\t\tmodel_name='modelb',\n\t\t\tname='modela',\n\t\t\tfield=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='app1.ModelB', to_field='field_wrong'),\n\t\t),\n\t]\n",
  "ground_truth": {
    "files": [
      "django/db/migrations/autodetector.py"
    ],
    "locations": [
      "django/db/migrations/autodetector.py::MigrationAutodetector",
      "django/db/migrations/autodetector.py::MigrationAutodetector.generate_altered_fields"
    ]
  },
  "predictions": [
    "tests/migrations/test_operations.py::OperationTests.test_alter_field_reloads_state_on_fk_with_to_field_target_changes",
    "tests/migrations/test_operations.py::OperationTests.test_alter_field_reloads_state_on_fk_target_changes",
    "tests/migrations/test_operations.py::OperationTests.test_rename_field_reloads_state_on_fk_target_changes",
    "tests/migrations/test_autodetector.py::AutodetectorTests.test_rename_model_reverse_relation_dependencies",
    "tests/migrations/test_autodetector.py::AutodetectorTests.test_rename_field_foreign_key_to_field",
    "tests/modeladmin/tests.py::ModelAdminTests.test_lookup_allowed_onetoone",
    "tests/migrations/test_operations.py::OperationTests.test_alter_field_reloads_state_on_fk_with_to_field_target_type_change",
    "tests/migrations/test_operations.py::OperationTests.test_alter_field_reloads_state_on_fk_with_to_field_related_name_target_type_change",
    "tests/migrations/test_autodetector.py::AutodetectorTests.test_rename_related_field_preserved_db_column",
    "tests/migrations/test_operations.py::OperationTests.test_rename_m2m_model_after_rename_field"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "d232fd76a85870daf345fd8f8d617fe7802ae194",
    "total_functions_indexed": 22878,
    "retrieval_time_seconds": 1.1840639114379883
  },
  "raw_output": "[{\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_alter_field_reloads_state_on_fk_with_to_field_target_changes\", \"score\": 198.9471911362165}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_alter_field_reloads_state_on_fk_target_changes\", \"score\": 179.83896658156272}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_rename_field_reloads_state_on_fk_target_changes\", \"score\": 178.44672291468862}, {\"doc_id\": \"tests/migrations/test_autodetector.py::AutodetectorTests.test_rename_model_reverse_relation_dependencies\", \"score\": 175.6997746622673}, {\"doc_id\": \"tests/migrations/test_autodetector.py::AutodetectorTests.test_rename_field_foreign_key_to_field\", \"score\": 168.38198636785154}, {\"doc_id\": \"tests/modeladmin/tests.py::ModelAdminTests.test_lookup_allowed_onetoone\", \"score\": 164.0246108482993}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_alter_field_reloads_state_on_fk_with_to_field_target_type_change\", \"score\": 163.94162928130766}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_alter_field_reloads_state_on_fk_with_to_field_related_name_target_type_change\", \"score\": 163.09270724775274}, {\"doc_id\": \"tests/migrations/test_autodetector.py::AutodetectorTests.test_rename_related_field_preserved_db_column\", \"score\": 160.26838179146662}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_rename_m2m_model_after_rename_field\", \"score\": 158.95868913196813}]"
}