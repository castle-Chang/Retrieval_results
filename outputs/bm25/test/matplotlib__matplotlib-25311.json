{
  "instance_id": "matplotlib__matplotlib-25311",
  "query": "[Bug]: Unable to pickle figure with draggable legend\n### Bug summary\r\n\r\nI am unable to pickle figure with draggable legend. Same error comes for draggable annotations.\r\n\r\n\r\n\r\n\r\n\r\n### Code for reproduction\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport pickle\r\n\r\nfig = plt.figure()\r\nax = fig.add_subplot(111)\r\n\r\ntime=[0,1,2,3,4]\r\nspeed=[40,43,45,47,48]\r\n\r\nax.plot(time,speed,label=\"speed\")\r\n\r\nleg=ax.legend()\r\nleg.set_draggable(True) #pickling works after removing this line \r\n\r\npickle.dumps(fig)\r\nplt.show()\r\n```\r\n\r\n\r\n### Actual outcome\r\n\r\n`TypeError: cannot pickle 'FigureCanvasQTAgg' object`\r\n\r\n### Expected outcome\r\n\r\nPickling successful\r\n\r\n### Additional information\r\n\r\n_No response_\r\n\r\n### Operating system\r\n\r\nWindows 10\r\n\r\n### Matplotlib Version\r\n\r\n3.7.0\r\n\r\n### Matplotlib Backend\r\n\r\n_No response_\r\n\r\n### Python version\r\n\r\n3.10\r\n\r\n### Jupyter version\r\n\r\n_No response_\r\n\r\n### Installation\r\n\r\npip\n",
  "ground_truth": {
    "files": [
      "lib/matplotlib/offsetbox.py"
    ],
    "locations": [
      "lib/matplotlib/offsetbox.py::DraggableBase",
      "lib/matplotlib/offsetbox.py::DraggableBase.__init__",
      "lib/matplotlib/offsetbox.py::DraggableBase.on_motion"
    ]
  },
  "predictions": [
    "lib/matplotlib/tests/test_pickle.py::test_simple",
    "lib/matplotlib/tests/test_pickle.py::test_no_pyplot",
    "lib/matplotlib/tests/test_legend.py::test_legend_draggable",
    "lib/matplotlib/tests/test_pickle.py::test_inset_and_secondary",
    "lib/matplotlib/tests/test_pickle.py::_pickle_load_subprocess",
    "lib/matplotlib/tests/test_pickle.py::test_shared",
    "lib/matplotlib/tests/test_legend.py::test_legend_proper_window_extent",
    "lib/matplotlib/tests/test_legend.py::test_legend_labelcolor_rcparam_single",
    "lib/matplotlib/tests/test_legend.py::test_legend_text_axes",
    "lib/matplotlib/tests/test_pickle.py::_generate_complete_test_figure"
  ],
  "metadata": {
    "repo": "matplotlib/matplotlib",
    "commit": "430fb1db88843300fb4baae3edc499bbfe073b0c",
    "total_functions_indexed": 9188,
    "retrieval_time_seconds": 0.3662550449371338
  },
  "raw_output": "[{\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_simple\", \"score\": 128.63056756734844}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_no_pyplot\", \"score\": 121.83544531119632}, {\"doc_id\": \"lib/matplotlib/tests/test_legend.py::test_legend_draggable\", \"score\": 121.70060480833492}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_inset_and_secondary\", \"score\": 99.53993422355329}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::_pickle_load_subprocess\", \"score\": 96.57853994132714}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_shared\", \"score\": 95.61769295338674}, {\"doc_id\": \"lib/matplotlib/tests/test_legend.py::test_legend_proper_window_extent\", \"score\": 92.29423759234551}, {\"doc_id\": \"lib/matplotlib/tests/test_legend.py::test_legend_labelcolor_rcparam_single\", \"score\": 90.37405192999562}, {\"doc_id\": \"lib/matplotlib/tests/test_legend.py::test_legend_text_axes\", \"score\": 89.54336942676844}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::_generate_complete_test_figure\", \"score\": 88.87936220500252}]"
}