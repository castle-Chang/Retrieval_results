{
  "instance_id": "django__django-13315",
  "query": "limit_choices_to on a ForeignKey can render duplicate options in formfield\nDescription\n\t\nIf you pass a Q object as limit_choices_to on a ForeignKey field involving a join, you may end up with duplicate options in your form.\nSee regressiontest in patch for a clear view on the problem.\n",
  "ground_truth": {
    "files": [
      "django/forms/models.py"
    ],
    "locations": [
      "django/forms/models.py::apply_limit_choices_to_to_formfield",
      "django/forms/models.py::fields_for_model"
    ]
  },
  "predictions": [
    "django/db/models/fields/related.py::RelatedField.formfield",
    "tests/admin_views/tests.py::AdminViewBasicTest.test_allowed_filtering_15103",
    "django/contrib/admin/options.py::BaseModelAdmin.lookup_allowed",
    "django/contrib/admin/options.py::BaseModelAdmin.formfield_for_dbfield",
    "django/contrib/admin/options.py::BaseModelAdmin.formfield_for_choice_field",
    "django/db/backends/postgresql/introspection.py::DatabaseIntrospection.get_table_description",
    "django/forms/widgets.py::Media.merge",
    "tests/model_forms/tests.py::LimitChoicesToTests.test_limit_choices_to_callable_for_fk_rel",
    "django/forms/models.py::ModelChoiceField.get_limit_choices_to",
    "django/utils/module_loading.py::autodiscover_modules"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "36bc47069ce071e80c8129500de3b8664d2058a7",
    "total_functions_indexed": 24033,
    "retrieval_time_seconds": 0.5614407062530518
  },
  "raw_output": "[{\"doc_id\": \"django/db/models/fields/related.py::RelatedField.formfield\", \"score\": 57.101692629937446}, {\"doc_id\": \"tests/admin_views/tests.py::AdminViewBasicTest.test_allowed_filtering_15103\", \"score\": 54.00933124183382}, {\"doc_id\": \"django/contrib/admin/options.py::BaseModelAdmin.lookup_allowed\", \"score\": 51.57564475328772}, {\"doc_id\": \"django/contrib/admin/options.py::BaseModelAdmin.formfield_for_dbfield\", \"score\": 48.3029062616503}, {\"doc_id\": \"django/contrib/admin/options.py::BaseModelAdmin.formfield_for_choice_field\", \"score\": 47.88141220494134}, {\"doc_id\": \"django/db/backends/postgresql/introspection.py::DatabaseIntrospection.get_table_description\", \"score\": 46.29933732937792}, {\"doc_id\": \"django/forms/widgets.py::Media.merge\", \"score\": 45.94773786060249}, {\"doc_id\": \"tests/model_forms/tests.py::LimitChoicesToTests.test_limit_choices_to_callable_for_fk_rel\", \"score\": 45.55002486582311}, {\"doc_id\": \"django/forms/models.py::ModelChoiceField.get_limit_choices_to\", \"score\": 44.8274179520182}, {\"doc_id\": \"django/utils/module_loading.py::autodiscover_modules\", \"score\": 44.3997665123381}]"
}