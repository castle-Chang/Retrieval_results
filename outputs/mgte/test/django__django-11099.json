{
  "instance_id": "django__django-11099",
  "query": "UsernameValidator allows trailing newline in usernames\nDescription\n\t\nASCIIUsernameValidator and UnicodeUsernameValidator use the regex \nr'^[\\w.@+-]+$'\nThe intent is to only allow alphanumeric characters as well as ., @, +, and -. However, a little known quirk of Python regexes is that $ will also match a trailing newline. Therefore, the user name validators will accept usernames which end with a newline. You can avoid this behavior by instead using \\A and \\Z to terminate regexes. For example, the validator regex could be changed to\nr'\\A[\\w.@+-]+\\Z'\nin order to reject usernames that end with a newline.\nI am not sure how to officially post a patch, but the required change is trivial - using the regex above in the two validators in contrib.auth.validators.\n",
  "ground_truth": {
    "files": [
      "django/contrib/auth/validators.py"
    ],
    "locations": [
      "django/contrib/auth/validators.py::ASCIIUsernameValidator",
      "django/contrib/auth/validators.py::UnicodeUsernameValidator"
    ]
  },
  "predictions": [
    "tests/auth_tests/test_validators.py::UsernameValidatorsTests.test_ascii_validator",
    "tests/auth_tests/test_validators.py::UsernameValidatorsTests.test_unicode_validator",
    "tests/auth_tests/test_remote_user.py::CustomRemoteUserBackend.clean_username",
    "django/contrib/auth/backends.py::RemoteUserBackend.clean_username",
    "django/contrib/auth/base_user.py::AbstractBaseUser.normalize_username",
    "django/contrib/auth/middleware.py::RemoteUserMiddleware.clean_username",
    "django/contrib/auth/models.py::AbstractUser.get_full_name",
    "django/contrib/auth/base_user.py::AbstractBaseUser.clean",
    "tests/auth_tests/test_models.py::AbstractBaseUserTests.test_clean_normalize_username",
    "tests/auth_tests/test_forms.py::UserChangeFormTest.test_username_validity"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "d26b2424437dabeeca94d7900b37d2df4410da0c",
    "total_functions_indexed": 22382,
    "retrieval_time_seconds": 0.006546497344970703
  },
  "raw_output": "[{\"doc_id\": \"tests/auth_tests/test_validators.py::UsernameValidatorsTests.test_ascii_validator\", \"score\": 0.738530695438385}, {\"doc_id\": \"tests/auth_tests/test_validators.py::UsernameValidatorsTests.test_unicode_validator\", \"score\": 0.7378309965133667}, {\"doc_id\": \"tests/auth_tests/test_remote_user.py::CustomRemoteUserBackend.clean_username\", \"score\": 0.7234952449798584}, {\"doc_id\": \"django/contrib/auth/backends.py::RemoteUserBackend.clean_username\", \"score\": 0.7149028778076172}, {\"doc_id\": \"django/contrib/auth/base_user.py::AbstractBaseUser.normalize_username\", \"score\": 0.7129475474357605}, {\"doc_id\": \"django/contrib/auth/middleware.py::RemoteUserMiddleware.clean_username\", \"score\": 0.6962229013442993}, {\"doc_id\": \"django/contrib/auth/models.py::AbstractUser.get_full_name\", \"score\": 0.694787323474884}, {\"doc_id\": \"django/contrib/auth/base_user.py::AbstractBaseUser.clean\", \"score\": 0.6900629997253418}, {\"doc_id\": \"tests/auth_tests/test_models.py::AbstractBaseUserTests.test_clean_normalize_username\", \"score\": 0.6809734106063843}, {\"doc_id\": \"tests/auth_tests/test_forms.py::UserChangeFormTest.test_username_validity\", \"score\": 0.6807687282562256}]"
}