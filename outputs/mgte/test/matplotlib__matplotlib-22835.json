{
  "instance_id": "matplotlib__matplotlib-22835",
  "query": "[Bug]: scalar mappable format_cursor_data crashes on BoundarNorm\n### Bug summary\r\n\r\nIn 3.5.0 if you do:\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nimport matplotlib as mpl\r\n\r\nfig, ax = plt.subplots()\r\nnorm = mpl.colors.BoundaryNorm(np.linspace(-4, 4, 5), 256)\r\nX = np.random.randn(10, 10)\r\npc = ax.imshow(X, cmap='RdBu_r', norm=norm)\r\n```\r\n\r\nand mouse over the image, it crashes with\r\n\r\n```\r\nFile \"/Users/jklymak/matplotlib/lib/matplotlib/artist.py\", line 1282, in format_cursor_data\r\n    neighbors = self.norm.inverse(\r\n  File \"/Users/jklymak/matplotlib/lib/matplotlib/colors.py\", line 1829, in inverse\r\n    raise ValueError(\"BoundaryNorm is not invertible\")\r\nValueError: BoundaryNorm is not invertible\r\n```\r\n\r\nand interaction stops.  \r\n\r\nNot sure if we should have a special check here, a try-except, or actually just make BoundaryNorm approximately invertible.  \r\n\r\n\r\n### Matplotlib Version\r\n\r\nmain 3.5.0\r\n\r\n\n[Bug]: scalar mappable format_cursor_data crashes on BoundarNorm\n### Bug summary\r\n\r\nIn 3.5.0 if you do:\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nimport matplotlib as mpl\r\n\r\nfig, ax = plt.subplots()\r\nnorm = mpl.colors.BoundaryNorm(np.linspace(-4, 4, 5), 256)\r\nX = np.random.randn(10, 10)\r\npc = ax.imshow(X, cmap='RdBu_r', norm=norm)\r\n```\r\n\r\nand mouse over the image, it crashes with\r\n\r\n```\r\nFile \"/Users/jklymak/matplotlib/lib/matplotlib/artist.py\", line 1282, in format_cursor_data\r\n    neighbors = self.norm.inverse(\r\n  File \"/Users/jklymak/matplotlib/lib/matplotlib/colors.py\", line 1829, in inverse\r\n    raise ValueError(\"BoundaryNorm is not invertible\")\r\nValueError: BoundaryNorm is not invertible\r\n```\r\n\r\nand interaction stops.  \r\n\r\nNot sure if we should have a special check here, a try-except, or actually just make BoundaryNorm approximately invertible.  \r\n\r\n\r\n### Matplotlib Version\r\n\r\nmain 3.5.0\r\n\r\n\n",
  "ground_truth": {
    "files": [
      "lib/matplotlib/artist.py"
    ],
    "locations": [
      "lib/matplotlib/artist.py::Artist",
      "lib/matplotlib/artist.py::Artist.format_cursor_data"
    ]
  },
  "predictions": [
    "lib/matplotlib/tests/test_colors.py::test_BoundaryNorm",
    "lib/matplotlib/colors.py::BoundaryNorm.inverse",
    "lib/matplotlib/artist.py::Artist.format_cursor_data",
    "lib/matplotlib/tests/test_image.py::test_cursor_data",
    "lib/matplotlib/image.py::AxesImage.get_cursor_data",
    "lib/matplotlib/tests/test_colors.py::test_boundarynorm_and_colorbarbase",
    "lib/matplotlib/colors.py::BoundaryNorm.__init__",
    "lib/matplotlib/tests/test_colorbar.py::test_negative_boundarynorm",
    "lib/matplotlib/colors.py::BoundaryNorm.__call__",
    "lib/matplotlib/tests/test_image.py::test_image_cursor_formatting"
  ],
  "metadata": {
    "repo": "matplotlib/matplotlib",
    "commit": "c33557d120eefe3148ebfcf2e758ff2357966000",
    "total_functions_indexed": 8926,
    "retrieval_time_seconds": 0.003192901611328125
  },
  "raw_output": "[{\"doc_id\": \"lib/matplotlib/tests/test_colors.py::test_BoundaryNorm\", \"score\": 0.7686354517936707}, {\"doc_id\": \"lib/matplotlib/colors.py::BoundaryNorm.inverse\", \"score\": 0.7577553391456604}, {\"doc_id\": \"lib/matplotlib/artist.py::Artist.format_cursor_data\", \"score\": 0.7445818781852722}, {\"doc_id\": \"lib/matplotlib/tests/test_image.py::test_cursor_data\", \"score\": 0.7377901077270508}, {\"doc_id\": \"lib/matplotlib/image.py::AxesImage.get_cursor_data\", \"score\": 0.7342489957809448}, {\"doc_id\": \"lib/matplotlib/tests/test_colors.py::test_boundarynorm_and_colorbarbase\", \"score\": 0.7279630899429321}, {\"doc_id\": \"lib/matplotlib/colors.py::BoundaryNorm.__init__\", \"score\": 0.7268257141113281}, {\"doc_id\": \"lib/matplotlib/tests/test_colorbar.py::test_negative_boundarynorm\", \"score\": 0.7268067598342896}, {\"doc_id\": \"lib/matplotlib/colors.py::BoundaryNorm.__call__\", \"score\": 0.7261813282966614}, {\"doc_id\": \"lib/matplotlib/tests/test_image.py::test_image_cursor_formatting\", \"score\": 0.7198774814605713}]"
}