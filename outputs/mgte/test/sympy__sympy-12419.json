{
  "instance_id": "sympy__sympy-12419",
  "query": "Sum of the elements of an identity matrix is zero\nI think this is a bug.\r\n\r\nI created a matrix by M.T * M under an assumption that M is orthogonal.  SymPy successfully recognized that the result is an identity matrix.  I tested its identity-ness by element-wise, queries, and sum of the diagonal elements and received expected results.\r\n\r\nHowever, when I attempt to evaluate the total sum of the elements the result was 0 while 'n' is expected.\r\n\r\n```\r\nfrom sympy import *\r\nfrom sympy import Q as Query\r\n\r\nn = Symbol('n', integer=True, positive=True)\r\ni, j = symbols('i j', integer=True)\r\nM = MatrixSymbol('M', n, n)\r\n\r\ne = None\r\nwith assuming(Query.orthogonal(M)):\r\n    e = refine((M.T * M).doit())\r\n\r\n# Correct: M.T * M is an identity matrix.\r\nprint(e, e[0, 0], e[0, 1], e[1, 0], e[1, 1])\r\n\r\n# Correct: The output is True True\r\nprint(ask(Query.diagonal(e)), ask(Query.integer_elements(e)))\r\n\r\n# Correct: The sum of the diagonal elements is n\r\nprint(Sum(e[i, i], (i, 0, n-1)).doit())\r\n\r\n# So far so good\r\n# Total sum of the elements is expected to be 'n' but the answer is 0!\r\nprint(Sum(Sum(e[i, j], (i, 0, n-1)), (j, 0, n-1)).doit())\r\n```\n",
  "ground_truth": {
    "files": [
      "sympy/matrices/expressions/matexpr.py"
    ],
    "locations": [
      "sympy/matrices/expressions/matexpr.py::MatrixElement",
      "sympy/matrices/expressions/matexpr.py::MatrixElement._eval_derivative",
      "sympy/matrices/expressions/matexpr.py::Identity",
      "sympy/matrices/expressions/matexpr.py::Identity.conjugate",
      "sympy/matrices/expressions/matexpr.py::Identity._entry",
      "sympy/matrices/expressions/matexpr.py::Identity._eval_determinant"
    ]
  },
  "predictions": [
    "sympy/matrices/expressions/tests/test_matexpr.py::test_Identity_doit",
    "sympy/matrices/expressions/tests/test_matexpr.py::test_Identity",
    "sympy/matrices/matrices.py::MatrixProperties._eval_is_Identity",
    "sympy/matrices/expressions/tests/test_matmul.py::test_refine",
    "sympy/assumptions/handlers/matrices.py::AskSymmetricHandler.MatrixSymbol",
    "sympy/concrete/tests/test_sums_products.py::test_matrix_sum",
    "sympy/matrices/expressions/tests/test_matexpr.py::test_ZeroMatrix",
    "sympy/matrices/expressions/matexpr.py::Identity.__new__",
    "sympy/matrices/dense.py::eye",
    "sympy/matrices/expressions/matmul.py::refine_MatMul"
  ],
  "metadata": {
    "repo": "sympy/sympy",
    "commit": "479939f8c65c8c2908bbedc959549a257a7c0b0b",
    "total_functions_indexed": 20518,
    "retrieval_time_seconds": 0.006227970123291016
  },
  "raw_output": "[{\"doc_id\": \"sympy/matrices/expressions/tests/test_matexpr.py::test_Identity_doit\", \"score\": 0.7317628860473633}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matexpr.py::test_Identity\", \"score\": 0.7180625200271606}, {\"doc_id\": \"sympy/matrices/matrices.py::MatrixProperties._eval_is_Identity\", \"score\": 0.7168906331062317}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matmul.py::test_refine\", \"score\": 0.7164928913116455}, {\"doc_id\": \"sympy/assumptions/handlers/matrices.py::AskSymmetricHandler.MatrixSymbol\", \"score\": 0.7160274982452393}, {\"doc_id\": \"sympy/concrete/tests/test_sums_products.py::test_matrix_sum\", \"score\": 0.714634358882904}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matexpr.py::test_ZeroMatrix\", \"score\": 0.7134356498718262}, {\"doc_id\": \"sympy/matrices/expressions/matexpr.py::Identity.__new__\", \"score\": 0.7116573452949524}, {\"doc_id\": \"sympy/matrices/dense.py::eye\", \"score\": 0.7114505767822266}, {\"doc_id\": \"sympy/matrices/expressions/matmul.py::refine_MatMul\", \"score\": 0.7106436491012573}]"
}