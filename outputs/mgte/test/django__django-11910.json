{
  "instance_id": "django__django-11910",
  "query": "ForeignKey's to_field parameter gets the old field's name when renaming a PrimaryKey.\nDescription\n\t\nHaving these two models \nclass ModelA(models.Model):\n\tfield_wrong = models.CharField('field1', max_length=50, primary_key=True) # I'm a Primary key.\nclass ModelB(models.Model):\n\tfield_fk = models.ForeignKey(ModelA, blank=True, null=True, on_delete=models.CASCADE) \n... migrations applyed ...\nthe ModelA.field_wrong field has been renamed ... and Django recognizes the \"renaming\"\n# Primary key renamed\nclass ModelA(models.Model):\n\tfield_fixed = models.CharField('field1', max_length=50, primary_key=True) # I'm a Primary key.\nAttempts to to_field parameter. \nThe to_field points to the old_name (field_typo) and not to the new one (\"field_fixed\")\nclass Migration(migrations.Migration):\n\tdependencies = [\n\t\t('app1', '0001_initial'),\n\t]\n\toperations = [\n\t\tmigrations.RenameField(\n\t\t\tmodel_name='modela',\n\t\t\told_name='field_wrong',\n\t\t\tnew_name='field_fixed',\n\t\t),\n\t\tmigrations.AlterField(\n\t\t\tmodel_name='modelb',\n\t\t\tname='modela',\n\t\t\tfield=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='app1.ModelB', to_field='field_wrong'),\n\t\t),\n\t]\n",
  "ground_truth": {
    "files": [
      "django/db/migrations/autodetector.py"
    ],
    "locations": [
      "django/db/migrations/autodetector.py::MigrationAutodetector",
      "django/db/migrations/autodetector.py::MigrationAutodetector.generate_altered_fields"
    ]
  },
  "predictions": [
    "django/db/migrations/operations/fields.py::RenameField.database_forwards",
    "django/db/migrations/operations/fields.py::RenameField.database_backwards",
    "django/db/migrations/operations/fields.py::RenameField.state_forwards",
    "django/db/backends/base/schema.py::BaseDatabaseSchemaEditor._rename_field_sql",
    "django/db/backends/mysql/schema.py::DatabaseSchemaEditor._rename_field_sql",
    "django/db/migrations/operations/fields.py::RenameField.__init__",
    "django/db/backends/sqlite3/schema.py::DatabaseSchemaEditor.alter_field",
    "django/db/migrations/operations/fields.py::RenameField.old_name_lower",
    "django/db/backends/sqlite3/schema.py::DatabaseSchemaEditor._alter_field",
    "tests/migrations/test_autodetector.py::AutodetectorTests.test_rename_field_foreign_key_to_field"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "d232fd76a85870daf345fd8f8d617fe7802ae194",
    "total_functions_indexed": 22878,
    "retrieval_time_seconds": 0.00601506233215332
  },
  "raw_output": "[{\"doc_id\": \"django/db/migrations/operations/fields.py::RenameField.database_forwards\", \"score\": 0.8061128854751587}, {\"doc_id\": \"django/db/migrations/operations/fields.py::RenameField.database_backwards\", \"score\": 0.8035767078399658}, {\"doc_id\": \"django/db/migrations/operations/fields.py::RenameField.state_forwards\", \"score\": 0.7982726693153381}, {\"doc_id\": \"django/db/backends/base/schema.py::BaseDatabaseSchemaEditor._rename_field_sql\", \"score\": 0.7906304597854614}, {\"doc_id\": \"django/db/backends/mysql/schema.py::DatabaseSchemaEditor._rename_field_sql\", \"score\": 0.7899576425552368}, {\"doc_id\": \"django/db/migrations/operations/fields.py::RenameField.__init__\", \"score\": 0.7869528532028198}, {\"doc_id\": \"django/db/backends/sqlite3/schema.py::DatabaseSchemaEditor.alter_field\", \"score\": 0.7866708040237427}, {\"doc_id\": \"django/db/migrations/operations/fields.py::RenameField.old_name_lower\", \"score\": 0.7810215950012207}, {\"doc_id\": \"django/db/backends/sqlite3/schema.py::DatabaseSchemaEditor._alter_field\", \"score\": 0.7777210474014282}, {\"doc_id\": \"tests/migrations/test_autodetector.py::AutodetectorTests.test_rename_field_foreign_key_to_field\", \"score\": 0.7751622796058655}]"
}