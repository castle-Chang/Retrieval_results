{
  "instance_id": "scikit-learn__scikit-learn-25638",
  "query": "Support nullable pandas dtypes in `unique_labels`\n### Describe the workflow you want to enable\n\nI would like to be able to pass the nullable pandas dtypes (\"Int64\", \"Float64\", \"boolean\") into sklearn's `unique_labels` function. Because the dtypes become `object` dtype when converted to numpy arrays we get `ValueError: Mix type of y not allowed, got types {'binary', 'unknown'}`:\r\n\r\nRepro with sklearn 1.2.1\r\n```py \r\n    import pandas as pd\r\n    import pytest\r\n    from sklearn.utils.multiclass import unique_labels\r\n    \r\n    for dtype in [\"Int64\", \"Float64\", \"boolean\"]:\r\n        y_true = pd.Series([1, 0, 0, 1, 0, 1, 1, 0, 1], dtype=dtype)\r\n        y_predicted = pd.Series([0, 0, 1, 1, 0, 1, 1, 1, 1], dtype=\"int64\")\r\n\r\n        with pytest.raises(ValueError, match=\"Mix type of y not allowed, got types\"):\r\n            unique_labels(y_true, y_predicted)\r\n```\n\n### Describe your proposed solution\n\nWe should get the same behavior as when `int64`, `float64`, and `bool` dtypes are used, which is no error:  \r\n\r\n```python\r\n    import pandas as pd\r\n    from sklearn.utils.multiclass import unique_labels\r\n    \r\n    for dtype in [\"int64\", \"float64\", \"bool\"]:\r\n        y_true = pd.Series([1, 0, 0, 1, 0, 1, 1, 0, 1], dtype=dtype)\r\n        y_predicted = pd.Series([0, 0, 1, 1, 0, 1, 1, 1, 1], dtype=\"int64\")\r\n\r\n        unique_labels(y_true, y_predicted)\r\n```\n\n### Describe alternatives you've considered, if relevant\n\nOur current workaround is to convert the data to numpy arrays with the corresponding dtype that works prior to passing it into `unique_labels`.\n\n### Additional context\n\n_No response_\n",
  "ground_truth": {
    "files": [
      "sklearn/utils/multiclass.py"
    ],
    "locations": [
      "sklearn/utils/multiclass.py::is_multilabel",
      "sklearn/utils/multiclass.py::type_of_target"
    ]
  },
  "predictions": [
    "sklearn/utils/multiclass.py::unique_labels",
    "sklearn/utils/tests/test_multiclass.py::test_unique_labels_non_specific",
    "sklearn/utils/tests/test_multiclass.py::test_unique_labels_mixed_types",
    "sklearn/utils/tests/test_multiclass.py::test_unique_labels",
    "sklearn/utils/multiclass.py::is_multilabel",
    "sklearn/utils/multiclass.py::_unique_multiclass",
    "sklearn/feature_selection/tests/test_mutual_info.py::test_compute_mi_cd_unique_label",
    "sklearn/metrics/tests/test_classification.py::test_hinge_loss_multiclass_missing_labels_with_labels_none",
    "sklearn/preprocessing/_label.py::label_binarize",
    "sklearn/metrics/tests/test_classification.py::test_hinge_loss_multiclass_missing_labels_only_two_unq_in_y_true"
  ],
  "metadata": {
    "repo": "scikit-learn/scikit-learn",
    "commit": "6adb209acd63825affc884abcd85381f148fb1b0",
    "total_functions_indexed": 9157,
    "retrieval_time_seconds": 0.18269872665405273
  },
  "raw_output": "[{\"doc_id\": \"sklearn/utils/multiclass.py::unique_labels\", \"score\": 0.808440089225769}, {\"doc_id\": \"sklearn/utils/tests/test_multiclass.py::test_unique_labels_non_specific\", \"score\": 0.8009406924247742}, {\"doc_id\": \"sklearn/utils/tests/test_multiclass.py::test_unique_labels_mixed_types\", \"score\": 0.7932194471359253}, {\"doc_id\": \"sklearn/utils/tests/test_multiclass.py::test_unique_labels\", \"score\": 0.7594305276870728}, {\"doc_id\": \"sklearn/utils/multiclass.py::is_multilabel\", \"score\": 0.7392323017120361}, {\"doc_id\": \"sklearn/utils/multiclass.py::_unique_multiclass\", \"score\": 0.7318301200866699}, {\"doc_id\": \"sklearn/feature_selection/tests/test_mutual_info.py::test_compute_mi_cd_unique_label\", \"score\": 0.7288958430290222}, {\"doc_id\": \"sklearn/metrics/tests/test_classification.py::test_hinge_loss_multiclass_missing_labels_with_labels_none\", \"score\": 0.723138153553009}, {\"doc_id\": \"sklearn/preprocessing/_label.py::label_binarize\", \"score\": 0.723072350025177}, {\"doc_id\": \"sklearn/metrics/tests/test_classification.py::test_hinge_loss_multiclass_missing_labels_only_two_unq_in_y_true\", \"score\": 0.7224841117858887}]"
}