{
  "instance_id": "matplotlib__matplotlib-25332",
  "query": "[Bug]: Unable to pickle figure with aligned labels\n### Bug summary\r\n\r\n Unable to pickle figure after calling `align_labels()`\r\n\r\n### Code for reproduction\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport pickle\r\n\r\nfig = plt.figure()\r\nax1 = fig.add_subplot(211)\r\nax2 = fig.add_subplot(212)\r\ntime=[0,1,2,3,4]\r\nspeed=[40000,4300,4500,4700,4800]\r\nacc=[10,11,12,13,14]\r\nax1.plot(time,speed)\r\nax1.set_ylabel('speed')\r\nax2.plot(time,acc)\r\nax2.set_ylabel('acc')\r\n\r\nfig.align_labels() ##pickling works after removing this line \r\n\r\npickle.dumps(fig)\r\nplt.show()\r\n```\r\n\r\n\r\n### Actual outcome\r\n```\r\nalign.py\", line 16\r\npickle.dumps(fig)\r\nTypeError: cannot pickle 'weakref.ReferenceType' object\r\n```\r\n### Expected outcome\r\n\r\nPickling successful\r\n\r\n### Additional information\r\n\r\n_No response_\r\n\r\n### Operating system\r\n\r\nWindows\r\n\r\n### Matplotlib Version\r\n\r\n3.7.0\r\n\r\n### Matplotlib Backend\r\n\r\n_No response_\r\n\r\n### Python version\r\n\r\n_No response_\r\n\r\n### Jupyter version\r\n\r\n_No response_\r\n\r\n### Installation\r\n\r\nNone\n",
  "ground_truth": {
    "files": [
      "lib/matplotlib/cbook.py"
    ],
    "locations": [
      "lib/matplotlib/cbook.py::Grouper",
      "lib/matplotlib/cbook.py::Grouper.__init__",
      "lib/matplotlib/cbook.py::Grouper.__contains__"
    ]
  },
  "predictions": [
    "lib/matplotlib/tests/test_pickle.py::test_no_pyplot",
    "lib/matplotlib/tests/test_constrainedlayout.py::test_align_labels",
    "lib/matplotlib/tests/test_pickle.py::test_complete",
    "lib/matplotlib/tests/test_pickle.py::test_gcf",
    "lib/matplotlib/tests/test_pickle.py::test_pickle_load_from_subprocess",
    "lib/matplotlib/tests/test_figure.py::test_align_labels",
    "lib/matplotlib/figure.py::FigureBase.align_labels",
    "lib/matplotlib/tests/test_figure.py::test_unpickle_with_device_pixel_ratio",
    "galleries/examples/text_labels_and_annotations/align_ylabels.py::make_plot",
    "lib/matplotlib/tests/test_pickle.py::_generate_complete_test_figure"
  ],
  "metadata": {
    "repo": "matplotlib/matplotlib",
    "commit": "66ba515e671638971bd11a34cff12c107a437e0b",
    "total_functions_indexed": 9189,
    "retrieval_time_seconds": 0.09319424629211426
  },
  "raw_output": "[{\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_no_pyplot\", \"score\": 0.7506054639816284}, {\"doc_id\": \"lib/matplotlib/tests/test_constrainedlayout.py::test_align_labels\", \"score\": 0.7411896586418152}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_complete\", \"score\": 0.7364730834960938}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_gcf\", \"score\": 0.7296249866485596}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_pickle_load_from_subprocess\", \"score\": 0.7254831790924072}, {\"doc_id\": \"lib/matplotlib/tests/test_figure.py::test_align_labels\", \"score\": 0.7250709533691406}, {\"doc_id\": \"lib/matplotlib/figure.py::FigureBase.align_labels\", \"score\": 0.722602903842926}, {\"doc_id\": \"lib/matplotlib/tests/test_figure.py::test_unpickle_with_device_pixel_ratio\", \"score\": 0.7224147319793701}, {\"doc_id\": \"galleries/examples/text_labels_and_annotations/align_ylabels.py::make_plot\", \"score\": 0.7219499349594116}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::_generate_complete_test_figure\", \"score\": 0.7199156284332275}]"
}