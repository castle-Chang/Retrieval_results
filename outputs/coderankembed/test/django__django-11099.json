{
  "instance_id": "django__django-11099",
  "query": "UsernameValidator allows trailing newline in usernames\nDescription\n\t\nASCIIUsernameValidator and UnicodeUsernameValidator use the regex \nr'^[\\w.@+-]+$'\nThe intent is to only allow alphanumeric characters as well as ., @, +, and -. However, a little known quirk of Python regexes is that $ will also match a trailing newline. Therefore, the user name validators will accept usernames which end with a newline. You can avoid this behavior by instead using \\A and \\Z to terminate regexes. For example, the validator regex could be changed to\nr'\\A[\\w.@+-]+\\Z'\nin order to reject usernames that end with a newline.\nI am not sure how to officially post a patch, but the required change is trivial - using the regex above in the two validators in contrib.auth.validators.\n",
  "ground_truth": {
    "files": [
      "django/contrib/auth/validators.py"
    ],
    "locations": [
      "django/contrib/auth/validators.py::ASCIIUsernameValidator",
      "django/contrib/auth/validators.py::UnicodeUsernameValidator"
    ]
  },
  "predictions": [
    "tests/auth_tests/test_validators.py::UsernameValidatorsTests.test_ascii_validator",
    "tests/auth_tests/test_validators.py::UsernameValidatorsTests.test_unicode_validator",
    "tests/auth_tests/test_remote_user.py::CustomRemoteUserBackend.clean_username",
    "django/contrib/auth/base_user.py::AbstractBaseUser.normalize_username",
    "django/contrib/auth/backends.py::RemoteUserBackend.clean_username",
    "django/contrib/auth/middleware.py::RemoteUserMiddleware.clean_username",
    "django/contrib/auth/management/commands/createsuperuser.py::Command._validate_username",
    "tests/auth_tests/test_checks.py::UserModelChecksTests.test_username_non_unique",
    "tests/admin_views/forms.py::CustomAdminAuthenticationForm.clean_username",
    "tests/auth_tests/test_forms.py::UserChangeFormTest.test_username_validity"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "d26b2424437dabeeca94d7900b37d2df4410da0c",
    "total_functions_indexed": 22382,
    "retrieval_time_seconds": 0.01158285140991211
  },
  "raw_output": "[{\"doc_id\": \"tests/auth_tests/test_validators.py::UsernameValidatorsTests.test_ascii_validator\", \"score\": 0.4821094870567322}, {\"doc_id\": \"tests/auth_tests/test_validators.py::UsernameValidatorsTests.test_unicode_validator\", \"score\": 0.48035678267478943}, {\"doc_id\": \"tests/auth_tests/test_remote_user.py::CustomRemoteUserBackend.clean_username\", \"score\": 0.4352559745311737}, {\"doc_id\": \"django/contrib/auth/base_user.py::AbstractBaseUser.normalize_username\", \"score\": 0.4072810709476471}, {\"doc_id\": \"django/contrib/auth/backends.py::RemoteUserBackend.clean_username\", \"score\": 0.404041051864624}, {\"doc_id\": \"django/contrib/auth/middleware.py::RemoteUserMiddleware.clean_username\", \"score\": 0.3863263726234436}, {\"doc_id\": \"django/contrib/auth/management/commands/createsuperuser.py::Command._validate_username\", \"score\": 0.385821670293808}, {\"doc_id\": \"tests/auth_tests/test_checks.py::UserModelChecksTests.test_username_non_unique\", \"score\": 0.3768332600593567}, {\"doc_id\": \"tests/admin_views/forms.py::CustomAdminAuthenticationForm.clean_username\", \"score\": 0.36790210008621216}, {\"doc_id\": \"tests/auth_tests/test_forms.py::UserChangeFormTest.test_username_validity\", \"score\": 0.3675263524055481}]"
}