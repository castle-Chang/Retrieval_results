{
  "instance_id": "sympy__sympy-13773",
  "query": "@ (__matmul__) should fail if one argument is not a matrix\n```\r\n>>> A = Matrix([[1, 2], [3, 4]])\r\n>>> B = Matrix([[2, 3], [1, 2]])\r\n>>> A@B\r\nMatrix([\r\n[ 4,  7],\r\n[10, 17]])\r\n>>> 2@B\r\nMatrix([\r\n[4, 6],\r\n[2, 4]])\r\n```\r\n\r\nRight now `@` (`__matmul__`) just copies `__mul__`, but it should actually only work if the multiplication is actually a matrix multiplication. \r\n\r\nThis is also how NumPy works\r\n\r\n```\r\n>>> import numpy as np\r\n>>> a = np.array([[1, 2], [3, 4]])\r\n>>> 2*a\r\narray([[2, 4],\r\n       [6, 8]])\r\n>>> 2@a\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nValueError: Scalar operands are not allowed, use '*' instead\r\n```\n",
  "ground_truth": {
    "files": [
      "sympy/matrices/common.py"
    ],
    "locations": [
      "sympy/matrices/common.py::MatrixArithmetic",
      "sympy/matrices/common.py::MatrixArithmetic.__matmul__",
      "sympy/matrices/common.py::MatrixArithmetic.__radd__",
      "sympy/matrices/common.py::MatrixArithmetic.__rmatmul__"
    ]
  },
  "predictions": [
    "sympy/matrices/common.py::MatrixArithmetic.__mul__",
    "sympy/external/tests/test_numpy.py::test_Matrix_mul",
    "sympy/matrices/expressions/tests/test_matmul.py::test_matmul_scalar_Matrix_doit",
    "sympy/matrices/expressions/tests/test_matmul.py::test_matmul_no_matrices",
    "sympy/core/tests/test_args.py::test_sympy__matrices__expressions__matmul__MatMul",
    "sympy/matrices/common.py::MatrixArithmetic.__matmul__",
    "sympy/matrices/expressions/tests/test_matmul.py::test_matmul_sympify",
    "sympy/matrices/common.py::MatrixArithmetic._eval_matrix_mul",
    "sympy/matrices/tests/test_matrices.py::test_multiplication",
    "sympy/matrices/expressions/tests/test_matmul.py::test_issue_12950"
  ],
  "metadata": {
    "repo": "sympy/sympy",
    "commit": "7121bdf1facdd90d05b6994b4c2e5b2865a4638a",
    "total_functions_indexed": 22391,
    "retrieval_time_seconds": 0.0065457820892333984
  },
  "raw_output": "[{\"doc_id\": \"sympy/matrices/common.py::MatrixArithmetic.__mul__\", \"score\": 0.5931767225265503}, {\"doc_id\": \"sympy/external/tests/test_numpy.py::test_Matrix_mul\", \"score\": 0.5929796099662781}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matmul.py::test_matmul_scalar_Matrix_doit\", \"score\": 0.5915846824645996}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matmul.py::test_matmul_no_matrices\", \"score\": 0.5811343789100647}, {\"doc_id\": \"sympy/core/tests/test_args.py::test_sympy__matrices__expressions__matmul__MatMul\", \"score\": 0.5773091316223145}, {\"doc_id\": \"sympy/matrices/common.py::MatrixArithmetic.__matmul__\", \"score\": 0.5539010167121887}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matmul.py::test_matmul_sympify\", \"score\": 0.5390802025794983}, {\"doc_id\": \"sympy/matrices/common.py::MatrixArithmetic._eval_matrix_mul\", \"score\": 0.5351055264472961}, {\"doc_id\": \"sympy/matrices/tests/test_matrices.py::test_multiplication\", \"score\": 0.5330020189285278}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matmul.py::test_issue_12950\", \"score\": 0.5315539240837097}]"
}