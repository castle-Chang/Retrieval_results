{
  "instance_id": "matplotlib__matplotlib-22835",
  "query": "[Bug]: scalar mappable format_cursor_data crashes on BoundarNorm\n### Bug summary\r\n\r\nIn 3.5.0 if you do:\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nimport matplotlib as mpl\r\n\r\nfig, ax = plt.subplots()\r\nnorm = mpl.colors.BoundaryNorm(np.linspace(-4, 4, 5), 256)\r\nX = np.random.randn(10, 10)\r\npc = ax.imshow(X, cmap='RdBu_r', norm=norm)\r\n```\r\n\r\nand mouse over the image, it crashes with\r\n\r\n```\r\nFile \"/Users/jklymak/matplotlib/lib/matplotlib/artist.py\", line 1282, in format_cursor_data\r\n    neighbors = self.norm.inverse(\r\n  File \"/Users/jklymak/matplotlib/lib/matplotlib/colors.py\", line 1829, in inverse\r\n    raise ValueError(\"BoundaryNorm is not invertible\")\r\nValueError: BoundaryNorm is not invertible\r\n```\r\n\r\nand interaction stops.  \r\n\r\nNot sure if we should have a special check here, a try-except, or actually just make BoundaryNorm approximately invertible.  \r\n\r\n\r\n### Matplotlib Version\r\n\r\nmain 3.5.0\r\n\r\n\n[Bug]: scalar mappable format_cursor_data crashes on BoundarNorm\n### Bug summary\r\n\r\nIn 3.5.0 if you do:\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nimport matplotlib as mpl\r\n\r\nfig, ax = plt.subplots()\r\nnorm = mpl.colors.BoundaryNorm(np.linspace(-4, 4, 5), 256)\r\nX = np.random.randn(10, 10)\r\npc = ax.imshow(X, cmap='RdBu_r', norm=norm)\r\n```\r\n\r\nand mouse over the image, it crashes with\r\n\r\n```\r\nFile \"/Users/jklymak/matplotlib/lib/matplotlib/artist.py\", line 1282, in format_cursor_data\r\n    neighbors = self.norm.inverse(\r\n  File \"/Users/jklymak/matplotlib/lib/matplotlib/colors.py\", line 1829, in inverse\r\n    raise ValueError(\"BoundaryNorm is not invertible\")\r\nValueError: BoundaryNorm is not invertible\r\n```\r\n\r\nand interaction stops.  \r\n\r\nNot sure if we should have a special check here, a try-except, or actually just make BoundaryNorm approximately invertible.  \r\n\r\n\r\n### Matplotlib Version\r\n\r\nmain 3.5.0\r\n\r\n\n",
  "ground_truth": {
    "files": [
      "lib/matplotlib/artist.py"
    ],
    "locations": [
      "lib/matplotlib/artist.py::Artist",
      "lib/matplotlib/artist.py::Artist.format_cursor_data"
    ]
  },
  "predictions": [
    "lib/matplotlib/tests/test_image.py::test_cursor_data",
    "lib/matplotlib/artist.py::Artist.format_cursor_data",
    "lib/matplotlib/tests/test_colorbar.py::test_negative_boundarynorm",
    "lib/matplotlib/tests/test_image.py::test_format_cursor_data",
    "lib/matplotlib/tests/test_colors.py::test_boundarynorm_and_colorbarbase",
    "lib/matplotlib/tests/test_image.py::test_image_cursor_formatting",
    "lib/matplotlib/tests/test_colors.py::test_BoundaryNorm",
    "lib/matplotlib/tests/test_image.py::test_norm_change",
    "lib/matplotlib/tests/test_polar.py::test_cursor_precision",
    "lib/matplotlib/tests/test_ticker.py::TestScalarFormatter.test_cursor_precision"
  ],
  "metadata": {
    "repo": "matplotlib/matplotlib",
    "commit": "c33557d120eefe3148ebfcf2e758ff2357966000",
    "total_functions_indexed": 8926,
    "retrieval_time_seconds": 0.09111833572387695
  },
  "raw_output": "[{\"doc_id\": \"lib/matplotlib/tests/test_image.py::test_cursor_data\", \"score\": 0.535008430480957}, {\"doc_id\": \"lib/matplotlib/artist.py::Artist.format_cursor_data\", \"score\": 0.4836013615131378}, {\"doc_id\": \"lib/matplotlib/tests/test_colorbar.py::test_negative_boundarynorm\", \"score\": 0.4780815839767456}, {\"doc_id\": \"lib/matplotlib/tests/test_image.py::test_format_cursor_data\", \"score\": 0.46880027651786804}, {\"doc_id\": \"lib/matplotlib/tests/test_colors.py::test_boundarynorm_and_colorbarbase\", \"score\": 0.45953670144081116}, {\"doc_id\": \"lib/matplotlib/tests/test_image.py::test_image_cursor_formatting\", \"score\": 0.448530912399292}, {\"doc_id\": \"lib/matplotlib/tests/test_colors.py::test_BoundaryNorm\", \"score\": 0.4428870677947998}, {\"doc_id\": \"lib/matplotlib/tests/test_image.py::test_norm_change\", \"score\": 0.4053441286087036}, {\"doc_id\": \"lib/matplotlib/tests/test_polar.py::test_cursor_precision\", \"score\": 0.40194544196128845}, {\"doc_id\": \"lib/matplotlib/tests/test_ticker.py::TestScalarFormatter.test_cursor_precision\", \"score\": 0.3995729684829712}]"
}