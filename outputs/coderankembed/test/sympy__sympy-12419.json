{
  "instance_id": "sympy__sympy-12419",
  "query": "Sum of the elements of an identity matrix is zero\nI think this is a bug.\r\n\r\nI created a matrix by M.T * M under an assumption that M is orthogonal.  SymPy successfully recognized that the result is an identity matrix.  I tested its identity-ness by element-wise, queries, and sum of the diagonal elements and received expected results.\r\n\r\nHowever, when I attempt to evaluate the total sum of the elements the result was 0 while 'n' is expected.\r\n\r\n```\r\nfrom sympy import *\r\nfrom sympy import Q as Query\r\n\r\nn = Symbol('n', integer=True, positive=True)\r\ni, j = symbols('i j', integer=True)\r\nM = MatrixSymbol('M', n, n)\r\n\r\ne = None\r\nwith assuming(Query.orthogonal(M)):\r\n    e = refine((M.T * M).doit())\r\n\r\n# Correct: M.T * M is an identity matrix.\r\nprint(e, e[0, 0], e[0, 1], e[1, 0], e[1, 1])\r\n\r\n# Correct: The output is True True\r\nprint(ask(Query.diagonal(e)), ask(Query.integer_elements(e)))\r\n\r\n# Correct: The sum of the diagonal elements is n\r\nprint(Sum(e[i, i], (i, 0, n-1)).doit())\r\n\r\n# So far so good\r\n# Total sum of the elements is expected to be 'n' but the answer is 0!\r\nprint(Sum(Sum(e[i, j], (i, 0, n-1)), (j, 0, n-1)).doit())\r\n```\n",
  "ground_truth": {
    "files": [
      "sympy/matrices/expressions/matexpr.py"
    ],
    "locations": [
      "sympy/matrices/expressions/matexpr.py::MatrixElement",
      "sympy/matrices/expressions/matexpr.py::MatrixElement._eval_derivative",
      "sympy/matrices/expressions/matexpr.py::Identity",
      "sympy/matrices/expressions/matexpr.py::Identity.conjugate",
      "sympy/matrices/expressions/matexpr.py::Identity._entry",
      "sympy/matrices/expressions/matexpr.py::Identity._eval_determinant"
    ]
  },
  "predictions": [
    "sympy/concrete/tests/test_sums_products.py::test_matrix_sum",
    "sympy/matrices/tests/test_matrices.py::test_sum",
    "sympy/external/tests/test_numpy.py::test_Matrix_sum",
    "sympy/matrices/expressions/tests/test_matexpr.py::test_Identity_doit",
    "sympy/matrices/expressions/tests/test_matexpr.py::test_ZeroMatrix",
    "sympy/matrices/expressions/tests/test_matexpr.py::test_Identity",
    "sympy/matrices/expressions/tests/test_determinant.py::test_eval_determinant",
    "sympy/matrices/tests/test_commonmatrix.py::test_is_Identity",
    "sympy/assumptions/tests/test_matrices.py::test_diagonal",
    "sympy/matrices/expressions/tests/test_determinant.py::test_refine"
  ],
  "metadata": {
    "repo": "sympy/sympy",
    "commit": "479939f8c65c8c2908bbedc959549a257a7c0b0b",
    "total_functions_indexed": 20518,
    "retrieval_time_seconds": 0.0037851333618164062
  },
  "raw_output": "[{\"doc_id\": \"sympy/concrete/tests/test_sums_products.py::test_matrix_sum\", \"score\": 0.5287998914718628}, {\"doc_id\": \"sympy/matrices/tests/test_matrices.py::test_sum\", \"score\": 0.4945005774497986}, {\"doc_id\": \"sympy/external/tests/test_numpy.py::test_Matrix_sum\", \"score\": 0.4933905601501465}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matexpr.py::test_Identity_doit\", \"score\": 0.49111175537109375}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matexpr.py::test_ZeroMatrix\", \"score\": 0.4846528172492981}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_matexpr.py::test_Identity\", \"score\": 0.4805661141872406}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_determinant.py::test_eval_determinant\", \"score\": 0.47746333479881287}, {\"doc_id\": \"sympy/matrices/tests/test_commonmatrix.py::test_is_Identity\", \"score\": 0.46451589465141296}, {\"doc_id\": \"sympy/assumptions/tests/test_matrices.py::test_diagonal\", \"score\": 0.4636034369468689}, {\"doc_id\": \"sympy/matrices/expressions/tests/test_determinant.py::test_refine\", \"score\": 0.46351343393325806}]"
}