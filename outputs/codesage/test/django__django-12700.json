{
  "instance_id": "django__django-12700",
  "query": "Settings are cleaned insufficiently.\nDescription\n\t\nPosting publicly after checking with the rest of the security team.\nI just ran into a case where django.views.debug.SafeExceptionReporterFilter.get_safe_settings() would return several un-cleansed values. Looking at cleanse_setting() I realized that we ​only take care of `dict`s but don't take other types of iterables into account but ​return them as-is.\nExample:\nIn my settings.py I have this:\nMY_SETTING = {\n\t\"foo\": \"value\",\n\t\"secret\": \"value\",\n\t\"token\": \"value\",\n\t\"something\": [\n\t\t{\"foo\": \"value\"},\n\t\t{\"secret\": \"value\"},\n\t\t{\"token\": \"value\"},\n\t],\n\t\"else\": [\n\t\t[\n\t\t\t{\"foo\": \"value\"},\n\t\t\t{\"secret\": \"value\"},\n\t\t\t{\"token\": \"value\"},\n\t\t],\n\t\t[\n\t\t\t{\"foo\": \"value\"},\n\t\t\t{\"secret\": \"value\"},\n\t\t\t{\"token\": \"value\"},\n\t\t],\n\t]\n}\nOn Django 3.0 and below:\n>>> import pprint\n>>> from django.views.debug import get_safe_settings\n>>> pprint.pprint(get_safe_settings()[\"MY_SETTING\"])\n{'else': [[{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}],\n\t\t [{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}]],\n 'foo': 'value',\n 'secret': '********************',\n 'something': [{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}],\n 'token': '********************'}\nOn Django 3.1 and up:\n>>> from django.views.debug import SafeExceptionReporterFilter\n>>> import pprint\n>>> pprint.pprint(SafeExceptionReporterFilter().get_safe_settings()[\"MY_SETTING\"])\n{'else': [[{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}],\n\t\t [{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}]],\n 'foo': 'value',\n 'secret': '********************',\n 'something': [{'foo': 'value'}, {'secret': 'value'}, {'token': 'value'}],\n 'token': '********************'}\n",
  "ground_truth": {
    "files": [
      "django/views/debug.py"
    ],
    "locations": [
      "django/views/debug.py::SafeExceptionReporterFilter",
      "django/views/debug.py::SafeExceptionReporterFilter.cleanse_setting"
    ]
  },
  "predictions": [
    "django/views/debug.py::SafeExceptionReporterFilter.get_safe_settings",
    "django/views/debug.py::SafeExceptionReporterFilter.get_safe_request_meta",
    "django/views/debug.py::SafeExceptionReporterFilter.cleanse_setting",
    "tests/view_tests/tests/test_debug.py::ExceptionReporterFilterTests.test_cleanse_setting_recurses_in_dictionary",
    "tests/view_tests/tests/test_debug.py::ExceptionReporterFilterTests.test_cleanse_setting_basic",
    "tests/view_tests/tests/test_debug.py::ExceptionReporterFilterTests.test_cleanse_setting_ignore_case",
    "django/views/debug.py::SafeExceptionReporterFilter.is_active",
    "tests/view_tests/tests/test_debug.py::CustomExceptionReporterFilterTests.test_hidden_settings_override",
    "tests/view_tests/tests/test_debug.py::CustomExceptionReporterFilterTests.test_cleansed_substitute_override",
    "django/views/debug.py::SafeExceptionReporterFilter.get_traceback_frame_variables"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "d51c50d836c5cf8db5566da17963f871be554615",
    "total_functions_indexed": 23430,
    "retrieval_time_seconds": 0.010416746139526367
  },
  "raw_output": "[{\"doc_id\": \"django/views/debug.py::SafeExceptionReporterFilter.get_safe_settings\", \"score\": 0.7319813966751099}, {\"doc_id\": \"django/views/debug.py::SafeExceptionReporterFilter.get_safe_request_meta\", \"score\": 0.642585039138794}, {\"doc_id\": \"django/views/debug.py::SafeExceptionReporterFilter.cleanse_setting\", \"score\": 0.5636274814605713}, {\"doc_id\": \"tests/view_tests/tests/test_debug.py::ExceptionReporterFilterTests.test_cleanse_setting_recurses_in_dictionary\", \"score\": 0.5339397192001343}, {\"doc_id\": \"tests/view_tests/tests/test_debug.py::ExceptionReporterFilterTests.test_cleanse_setting_basic\", \"score\": 0.5301513671875}, {\"doc_id\": \"tests/view_tests/tests/test_debug.py::ExceptionReporterFilterTests.test_cleanse_setting_ignore_case\", \"score\": 0.5081740617752075}, {\"doc_id\": \"django/views/debug.py::SafeExceptionReporterFilter.is_active\", \"score\": 0.5003215074539185}, {\"doc_id\": \"tests/view_tests/tests/test_debug.py::CustomExceptionReporterFilterTests.test_hidden_settings_override\", \"score\": 0.42714136838912964}, {\"doc_id\": \"tests/view_tests/tests/test_debug.py::CustomExceptionReporterFilterTests.test_cleansed_substitute_override\", \"score\": 0.4165836274623871}, {\"doc_id\": \"django/views/debug.py::SafeExceptionReporterFilter.get_traceback_frame_variables\", \"score\": 0.4070442318916321}]"
}