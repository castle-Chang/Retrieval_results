{
  "instance_id": "matplotlib__matplotlib-25311",
  "query": "[Bug]: Unable to pickle figure with draggable legend\n### Bug summary\r\n\r\nI am unable to pickle figure with draggable legend. Same error comes for draggable annotations.\r\n\r\n\r\n\r\n\r\n\r\n### Code for reproduction\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport pickle\r\n\r\nfig = plt.figure()\r\nax = fig.add_subplot(111)\r\n\r\ntime=[0,1,2,3,4]\r\nspeed=[40,43,45,47,48]\r\n\r\nax.plot(time,speed,label=\"speed\")\r\n\r\nleg=ax.legend()\r\nleg.set_draggable(True) #pickling works after removing this line \r\n\r\npickle.dumps(fig)\r\nplt.show()\r\n```\r\n\r\n\r\n### Actual outcome\r\n\r\n`TypeError: cannot pickle 'FigureCanvasQTAgg' object`\r\n\r\n### Expected outcome\r\n\r\nPickling successful\r\n\r\n### Additional information\r\n\r\n_No response_\r\n\r\n### Operating system\r\n\r\nWindows 10\r\n\r\n### Matplotlib Version\r\n\r\n3.7.0\r\n\r\n### Matplotlib Backend\r\n\r\n_No response_\r\n\r\n### Python version\r\n\r\n3.10\r\n\r\n### Jupyter version\r\n\r\n_No response_\r\n\r\n### Installation\r\n\r\npip\n",
  "ground_truth": {
    "files": [
      "lib/matplotlib/offsetbox.py"
    ],
    "locations": [
      "lib/matplotlib/offsetbox.py::DraggableBase",
      "lib/matplotlib/offsetbox.py::DraggableBase.__init__",
      "lib/matplotlib/offsetbox.py::DraggableBase.on_motion"
    ]
  },
  "predictions": [
    "lib/matplotlib/tests/test_pickle.py::test_unpickle_canvas",
    "lib/matplotlib/tests/test_pickle.py::test_no_pyplot",
    "lib/matplotlib/tests/test_pickle.py::test_image",
    "lib/matplotlib/tests/test_pickle.py::test_renderer",
    "lib/matplotlib/tests/test_pickle.py::test_complete",
    "lib/matplotlib/tests/test_pickle.py::_generate_complete_test_figure",
    "lib/matplotlib/tests/test_pickle.py::test_gcf",
    "lib/matplotlib/tests/test_pickle.py::test_simple",
    "lib/matplotlib/tests/test_pickle.py::test_polar",
    "lib/matplotlib/backends/backend_agg.py::FigureCanvasAgg.print_tif"
  ],
  "metadata": {
    "repo": "matplotlib/matplotlib",
    "commit": "430fb1db88843300fb4baae3edc499bbfe073b0c",
    "total_functions_indexed": 9188,
    "retrieval_time_seconds": 0.17462611198425293
  },
  "raw_output": "[{\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_unpickle_canvas\", \"score\": 0.5661059617996216}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_no_pyplot\", \"score\": 0.564005970954895}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_image\", \"score\": 0.5356120467185974}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_renderer\", \"score\": 0.48755186796188354}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_complete\", \"score\": 0.4846433997154236}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::_generate_complete_test_figure\", \"score\": 0.4723353385925293}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_gcf\", \"score\": 0.4713589549064636}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_simple\", \"score\": 0.461883544921875}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_polar\", \"score\": 0.4580927789211273}, {\"doc_id\": \"lib/matplotlib/backends/backend_agg.py::FigureCanvasAgg.print_tif\", \"score\": 0.4457162022590637}]"
}