{
  "instance_id": "django__django-13786",
  "query": "squashmigrations does not unset model options when optimizing CreateModel and AlterModelOptions\nDescription\n\t\nWhen an operation resembling AlterModelOptions(name=\"test_model\", options={}) is squashed into the corresponding CreateModel operation, model options are not cleared on the resulting new CreateModel operation object.\nCreateModel.reduce() sets the new options as options={**self.options, **operation.options} in this case (django/db/migrations/operations/models.py line 144 on commit 991dce4f), with no logic to remove options not found in operation.options as is found in AlterModelOptions.state_forwards().\nI believe this issue still exists on the master branch based on my reading of the code, but I've only tested against 2.2.\n",
  "ground_truth": {
    "files": [
      "django/db/migrations/operations/models.py"
    ],
    "locations": [
      "django/db/migrations/operations/models.py::CreateModel",
      "django/db/migrations/operations/models.py::CreateModel.reduce"
    ]
  },
  "predictions": [
    "django/db/migrations/operations/models.py::CreateModel.reduce",
    "tests/migrations/test_operations.py::OperationTests.test_alter_model_options_emptying",
    "tests/migrations/test_operations.py::OperationTests.test_alter_model_options",
    "tests/migrations/test_operations.py::OperationTests.test_separate_database_and_state2",
    "tests/migrations/test_operations.py::OperationTests.test_create_proxy_model",
    "django/db/migrations/autodetector.py::MigrationAutodetector.generate_created_proxies",
    "tests/migrations/test_optimizer.py::OptimizerTests.test_create_alter_model_options",
    "tests/migrations/test_operations.py::OperationTests.test_create_model_with_constraint",
    "django/db/migrations/operations/models.py::AlterModelOptions.state_forwards",
    "django/db/migrations/operations/models.py::AlterModelOptions.__init__"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "bb64b99b78a579cb2f6178011a4cf9366e634438",
    "total_functions_indexed": 24230,
    "retrieval_time_seconds": 1.4912807941436768
  },
  "raw_output": "[{\"doc_id\": \"django/db/migrations/operations/models.py::CreateModel.reduce\", \"score\": 166.21863402636728}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_alter_model_options_emptying\", \"score\": 165.49669681429316}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_alter_model_options\", \"score\": 157.1837813808457}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_separate_database_and_state2\", \"score\": 135.34265206704433}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_create_proxy_model\", \"score\": 131.22913394122395}, {\"doc_id\": \"django/db/migrations/autodetector.py::MigrationAutodetector.generate_created_proxies\", \"score\": 130.54604783049953}, {\"doc_id\": \"tests/migrations/test_optimizer.py::OptimizerTests.test_create_alter_model_options\", \"score\": 128.42633476046535}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_create_model_with_constraint\", \"score\": 125.01094662409632}, {\"doc_id\": \"django/db/migrations/operations/models.py::AlterModelOptions.state_forwards\", \"score\": 120.46985095039504}, {\"doc_id\": \"django/db/migrations/operations/models.py::AlterModelOptions.__init__\", \"score\": 117.4271786275026}]"
}