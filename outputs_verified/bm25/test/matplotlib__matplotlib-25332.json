{
  "instance_id": "matplotlib__matplotlib-25332",
  "query": "[Bug]: Unable to pickle figure with aligned labels\n### Bug summary\r\n\r\n Unable to pickle figure after calling `align_labels()`\r\n\r\n### Code for reproduction\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport pickle\r\n\r\nfig = plt.figure()\r\nax1 = fig.add_subplot(211)\r\nax2 = fig.add_subplot(212)\r\ntime=[0,1,2,3,4]\r\nspeed=[40000,4300,4500,4700,4800]\r\nacc=[10,11,12,13,14]\r\nax1.plot(time,speed)\r\nax1.set_ylabel('speed')\r\nax2.plot(time,acc)\r\nax2.set_ylabel('acc')\r\n\r\nfig.align_labels() ##pickling works after removing this line \r\n\r\npickle.dumps(fig)\r\nplt.show()\r\n```\r\n\r\n\r\n### Actual outcome\r\n```\r\nalign.py\", line 16\r\npickle.dumps(fig)\r\nTypeError: cannot pickle 'weakref.ReferenceType' object\r\n```\r\n### Expected outcome\r\n\r\nPickling successful\r\n\r\n### Additional information\r\n\r\n_No response_\r\n\r\n### Operating system\r\n\r\nWindows\r\n\r\n### Matplotlib Version\r\n\r\n3.7.0\r\n\r\n### Matplotlib Backend\r\n\r\n_No response_\r\n\r\n### Python version\r\n\r\n_No response_\r\n\r\n### Jupyter version\r\n\r\n_No response_\r\n\r\n### Installation\r\n\r\nNone\n",
  "ground_truth": {
    "files": [
      "lib/matplotlib/cbook.py"
    ],
    "locations": [
      "lib/matplotlib/cbook.py::Grouper",
      "lib/matplotlib/cbook.py::Grouper.__init__",
      "lib/matplotlib/cbook.py::Grouper.__contains__"
    ]
  },
  "predictions": [
    "lib/matplotlib/tests/test_pickle.py::test_no_pyplot",
    "lib/matplotlib/tests/test_pickle.py::test_simple",
    "lib/matplotlib/tests/test_pickle.py::_pickle_load_subprocess",
    "lib/matplotlib/tests/test_pickle.py::test_shared",
    "lib/mpl_toolkits/mplot3d/tests/test_axes3d.py::test_shared_axes_retick",
    "lib/matplotlib/tests/test_figure.py::test_unpickle_with_device_pixel_ratio",
    "lib/matplotlib/tests/test_pickle.py::test_inset_and_secondary",
    "lib/matplotlib/tests/test_pickle.py::test_vertexselector",
    "lib/matplotlib/tests/test_constrainedlayout.py::test_align_labels",
    "lib/matplotlib/tests/test_pickle.py::test_polar"
  ],
  "metadata": {
    "repo": "matplotlib/matplotlib",
    "commit": "66ba515e671638971bd11a34cff12c107a437e0b",
    "total_functions_indexed": 9189,
    "retrieval_time_seconds": 0.6716079711914062
  },
  "raw_output": "[{\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_no_pyplot\", \"score\": 137.52616001527616}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_simple\", \"score\": 127.2209925672099}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::_pickle_load_subprocess\", \"score\": 124.14328516884927}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_shared\", \"score\": 119.34688918082323}, {\"doc_id\": \"lib/mpl_toolkits/mplot3d/tests/test_axes3d.py::test_shared_axes_retick\", \"score\": 119.29492092887641}, {\"doc_id\": \"lib/matplotlib/tests/test_figure.py::test_unpickle_with_device_pixel_ratio\", \"score\": 117.56516192478617}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_inset_and_secondary\", \"score\": 115.0387709430677}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_vertexselector\", \"score\": 114.95455888737636}, {\"doc_id\": \"lib/matplotlib/tests/test_constrainedlayout.py::test_align_labels\", \"score\": 113.89530991495747}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_polar\", \"score\": 113.40917723731484}]"
}