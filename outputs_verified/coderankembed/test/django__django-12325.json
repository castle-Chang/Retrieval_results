{
  "instance_id": "django__django-12325",
  "query": "pk setup for MTI to parent get confused by multiple OneToOne references.\nDescription\n\t\nclass Document(models.Model):\n\tpass\nclass Picking(Document):\n\tdocument_ptr = models.OneToOneField(Document, on_delete=models.CASCADE, parent_link=True, related_name='+')\n\torigin = models.OneToOneField(Document, related_name='picking', on_delete=models.PROTECT)\nproduces django.core.exceptions.ImproperlyConfigured: Add parent_link=True to appname.Picking.origin.\nclass Picking(Document):\n\torigin = models.OneToOneField(Document, related_name='picking', on_delete=models.PROTECT)\n\tdocument_ptr = models.OneToOneField(Document, on_delete=models.CASCADE, parent_link=True, related_name='+')\nWorks\nFirst issue is that order seems to matter?\nEven if ordering is required \"by design\"(It shouldn't be we have explicit parent_link marker) shouldn't it look from top to bottom like it does with managers and other things?\n",
  "ground_truth": {
    "files": [
      "django/db/models/options.py",
      "django/db/models/base.py"
    ],
    "locations": [
      "django/db/models/base.py::ModelBase",
      "django/db/models/base.py::ModelBase.__new__",
      "django/db/models/options.py::Options",
      "django/db/models/options.py::Options._prepare"
    ]
  },
  "predictions": [
    "tests/invalid_models_tests/test_models.py::OtherModelTests.test_ordering_pointing_to_related_model_pk",
    "tests/model_inheritance_regress/tests.py::ModelInheritanceTest.test_use_explicit_o2o_to_parent_as_pk",
    "django/db/models/options.py::Options._prepare",
    "django/db/models/base.py::Model._set_pk_val",
    "django/db/models/fields/related_descriptors.py::ForwardOneToOneDescriptor.__set__",
    "tests/invalid_models_tests/test_models.py::OtherModelTests.test_ordering_pointing_multiple_times_to_model_fields",
    "tests/invalid_models_tests/test_models.py::OtherModelTests.test_missing_parent_link",
    "tests/invalid_models_tests/test_models.py::OtherModelTests.test_ordering_pointing_to_foreignkey_field",
    "django/db/models/fields/related.py::ForeignKey.__init__",
    "django/db/models/fields/related.py::OneToOneField.formfield"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "29c126bb349526b5f1cd78facbe9f25906f18563",
    "total_functions_indexed": 23161,
    "retrieval_time_seconds": 0.010544776916503906
  },
  "raw_output": "[{\"doc_id\": \"tests/invalid_models_tests/test_models.py::OtherModelTests.test_ordering_pointing_to_related_model_pk\", \"score\": 0.5031418204307556}, {\"doc_id\": \"tests/model_inheritance_regress/tests.py::ModelInheritanceTest.test_use_explicit_o2o_to_parent_as_pk\", \"score\": 0.4709950387477875}, {\"doc_id\": \"django/db/models/options.py::Options._prepare\", \"score\": 0.4678082764148712}, {\"doc_id\": \"django/db/models/base.py::Model._set_pk_val\", \"score\": 0.4546884000301361}, {\"doc_id\": \"django/db/models/fields/related_descriptors.py::ForwardOneToOneDescriptor.__set__\", \"score\": 0.4530484676361084}, {\"doc_id\": \"tests/invalid_models_tests/test_models.py::OtherModelTests.test_ordering_pointing_multiple_times_to_model_fields\", \"score\": 0.44979384541511536}, {\"doc_id\": \"tests/invalid_models_tests/test_models.py::OtherModelTests.test_missing_parent_link\", \"score\": 0.4393270015716553}, {\"doc_id\": \"tests/invalid_models_tests/test_models.py::OtherModelTests.test_ordering_pointing_to_foreignkey_field\", \"score\": 0.42689377069473267}, {\"doc_id\": \"django/db/models/fields/related.py::ForeignKey.__init__\", \"score\": 0.4212827980518341}, {\"doc_id\": \"django/db/models/fields/related.py::OneToOneField.formfield\", \"score\": 0.41987305879592896}]"
}