{
  "instance_id": "django__django-17087",
  "query": "Class methods from nested classes cannot be used as Field.default.\nDescription\n\t \n\t\t(last modified by Mariusz Felisiak)\n\t \nGiven the following model:\n \nclass Profile(models.Model):\n\tclass Capability(models.TextChoices):\n\t\tBASIC = (\"BASIC\", \"Basic\")\n\t\tPROFESSIONAL = (\"PROFESSIONAL\", \"Professional\")\n\t\t\n\t\t@classmethod\n\t\tdef default(cls) -> list[str]:\n\t\t\treturn [cls.BASIC]\n\tcapabilities = ArrayField(\n\t\tmodels.CharField(choices=Capability.choices, max_length=30, blank=True),\n\t\tnull=True,\n\t\tdefault=Capability.default\n\t)\nThe resulting migration contained the following:\n # ...\n\t migrations.AddField(\n\t\t model_name='profile',\n\t\t name='capabilities',\n\t\t field=django.contrib.postgres.fields.ArrayField(base_field=models.CharField(blank=True, choices=[('BASIC', 'Basic'), ('PROFESSIONAL', 'Professional')], max_length=30), default=appname.models.Capability.default, null=True, size=None),\n\t ),\n # ...\nAs you can see, migrations.AddField is passed as argument \"default\" a wrong value \"appname.models.Capability.default\", which leads to an error when trying to migrate. The right value should be \"appname.models.Profile.Capability.default\".\n",
  "ground_truth": {
    "files": [
      "django/db/migrations/serializer.py"
    ],
    "locations": [
      "django/db/migrations/serializer.py::FunctionTypeSerializer",
      "django/db/migrations/serializer.py::FunctionTypeSerializer.serialize"
    ]
  },
  "predictions": [
    "django/contrib/postgres/fields/ranges.py::RangeField.__init__",
    "tests/postgres_tests/test_array.py::TestMigrations.test_adding_field_with_default",
    "django/contrib/postgres/fields/ranges.py::RangeField.formfield",
    "django/db/migrations/operations/fields.py::AddField.__init__",
    "django/db/migrations/operations/fields.py::AddField.reduce",
    "django/db/migrations/operations/fields.py::AddField.deconstruct",
    "django/db/migrations/operations/fields.py::AddField.database_forwards",
    "django/db/models/fields/__init__.py::Field.contribute_to_class",
    "django/db/models/fields/__init__.py::Field.db_returning",
    "tests/postgres_tests/models.py::ArrayFieldSubclass.__init__"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "4a72da71001f154ea60906a2f74898d32b7322a7",
    "total_functions_indexed": 26796,
    "retrieval_time_seconds": 0.03496861457824707
  },
  "raw_output": "[{\"doc_id\": \"django/contrib/postgres/fields/ranges.py::RangeField.__init__\", \"score\": 0.4983556568622589}, {\"doc_id\": \"tests/postgres_tests/test_array.py::TestMigrations.test_adding_field_with_default\", \"score\": 0.4640964865684509}, {\"doc_id\": \"django/contrib/postgres/fields/ranges.py::RangeField.formfield\", \"score\": 0.4623916745185852}, {\"doc_id\": \"django/db/migrations/operations/fields.py::AddField.__init__\", \"score\": 0.460627019405365}, {\"doc_id\": \"django/db/migrations/operations/fields.py::AddField.reduce\", \"score\": 0.4587106704711914}, {\"doc_id\": \"django/db/migrations/operations/fields.py::AddField.deconstruct\", \"score\": 0.4535810947418213}, {\"doc_id\": \"django/db/migrations/operations/fields.py::AddField.database_forwards\", \"score\": 0.44716525077819824}, {\"doc_id\": \"django/db/models/fields/__init__.py::Field.contribute_to_class\", \"score\": 0.4361439347267151}, {\"doc_id\": \"django/db/models/fields/__init__.py::Field.db_returning\", \"score\": 0.4342607855796814}, {\"doc_id\": \"tests/postgres_tests/models.py::ArrayFieldSubclass.__init__\", \"score\": 0.4298137426376343}]"
}