{
  "instance_id": "django__django-16560",
  "query": "Allow to customize the code attribute of ValidationError raised by BaseConstraint.validate\nDescription\n\t\nIt is currently possible to customize the violation_error_message of a ValidationError raised by a constraint but not the code.\nI'd like to add a new violation_error_message parameter to BaseConstraint to allow to easily add one.\nCurrently, to achieve the same result, you have to subclass the constraint to tweak validate to catch and reraise the ValidationError.\nSince the documentation recommends to Provide a descriptive error code to the constructor: when raising a ValidationError in â€‹https://docs.djangoproject.com/en/4.1/ref/forms/validation/#raising-validationerror , I think it would make sense to provide this possibility for errors raised by constraints.\nIf you think it would be a good idea, I'd be happy to work on a PR.\n",
  "ground_truth": {
    "files": [
      "django/contrib/postgres/constraints.py",
      "django/db/models/constraints.py"
    ],
    "locations": [
      "django/contrib/postgres/constraints.py::ExclusionConstraint",
      "django/contrib/postgres/constraints.py::ExclusionConstraint.__init__",
      "django/contrib/postgres/constraints.py::ExclusionConstraint._get_expressions",
      "django/contrib/postgres/constraints.py::ExclusionConstraint.__eq__",
      "django/contrib/postgres/constraints.py::ExclusionConstraint.__repr__",
      "django/contrib/postgres/constraints.py::ExclusionConstraint.validate",
      "django/db/models/constraints.py::BaseConstraint",
      "django/db/models/constraints.py::BaseConstraint.__init__",
      "django/db/models/constraints.py::BaseConstraint.deconstruct",
      "django/db/models/constraints.py::BaseConstraint.clone",
      "django/db/models/constraints.py::CheckConstraint",
      "django/db/models/constraints.py::CheckConstraint.__init__",
      "django/db/models/constraints.py::CheckConstraint._get_check_sql",
      "django/db/models/constraints.py::CheckConstraint.validate",
      "django/db/models/constraints.py::CheckConstraint.__repr__",
      "django/db/models/constraints.py::CheckConstraint.__eq__",
      "django/db/models/constraints.py::UniqueConstraint",
      "django/db/models/constraints.py::UniqueConstraint.__init__",
      "django/db/models/constraints.py::UniqueConstraint.contains_expressions",
      "django/db/models/constraints.py::UniqueConstraint.remove_sql",
      "django/db/models/constraints.py::UniqueConstraint.__repr__",
      "django/db/models/constraints.py::UniqueConstraint.__eq__",
      "django/db/models/constraints.py::UniqueConstraint.validate"
    ]
  },
  "predictions": [
    "django/db/models/constraints.py::BaseConstraint.get_violation_error_message",
    "tests/constraints/tests.py::BaseConstraintTests.test_custom_violation_error_message",
    "tests/constraints/tests.py::BaseConstraintTests.test_custom_violation_error_message_clone",
    "tests/constraints/tests.py::BaseConstraintTests.test_default_violation_error_message",
    "django/core/exceptions.py::ValidationError.message_dict",
    "django/core/exceptions.py::ValidationError.__repr__",
    "tests/constraints/tests.py::UniqueConstraintTests.test_model_validation_constraint_no_code_error",
    "django/contrib/postgres/operations.py::ValidateConstraint.describe",
    "tests/constraints/tests.py::BaseConstraintTests.test_validate",
    "django/contrib/postgres/utils.py::prefix_validation_error"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "51c9bb7cd16081133af4f0ab6d06572660309730",
    "total_functions_indexed": 26404,
    "retrieval_time_seconds": 0.005876302719116211
  },
  "raw_output": "[{\"doc_id\": \"django/db/models/constraints.py::BaseConstraint.get_violation_error_message\", \"score\": 0.5547270178794861}, {\"doc_id\": \"tests/constraints/tests.py::BaseConstraintTests.test_custom_violation_error_message\", \"score\": 0.5476280450820923}, {\"doc_id\": \"tests/constraints/tests.py::BaseConstraintTests.test_custom_violation_error_message_clone\", \"score\": 0.49839961528778076}, {\"doc_id\": \"tests/constraints/tests.py::BaseConstraintTests.test_default_violation_error_message\", \"score\": 0.4737344980239868}, {\"doc_id\": \"django/core/exceptions.py::ValidationError.message_dict\", \"score\": 0.4558144509792328}, {\"doc_id\": \"django/core/exceptions.py::ValidationError.__repr__\", \"score\": 0.43094250559806824}, {\"doc_id\": \"tests/constraints/tests.py::UniqueConstraintTests.test_model_validation_constraint_no_code_error\", \"score\": 0.4261745512485504}, {\"doc_id\": \"django/contrib/postgres/operations.py::ValidateConstraint.describe\", \"score\": 0.4223648011684418}, {\"doc_id\": \"tests/constraints/tests.py::BaseConstraintTests.test_validate\", \"score\": 0.41792091727256775}, {\"doc_id\": \"django/contrib/postgres/utils.py::prefix_validation_error\", \"score\": 0.41598761081695557}]"
}