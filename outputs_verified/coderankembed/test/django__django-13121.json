{
  "instance_id": "django__django-13121",
  "query": "durations-only expressions doesn't work on SQLite and MySQL\nDescription\n\t\nclass Experiment(models.Model):\n\testimated_time = models.DurationField()\nlist(Experiment.objects.annotate(duration=F('estimated_time') + datime.timedelta(1)))\nTraceback (most recent call last):\n File \"/home/sergey/dev/django/tests/expressions/tests.py\", line 1218, in test_duration_expressions\n\tlist(Experiment.objects.annotate(duration=F('estimated_time') + delta))\n File \"/home/sergey/dev/django/django/db/models/query.py\", line 269, in __iter__\n\tself._fetch_all()\n File \"/home/sergey/dev/django/django/db/models/query.py\", line 1172, in _fetch_all\n\tself._result_cache = list(self._iterable_class(self))\n File \"/home/sergey/dev/django/django/db/models/query.py\", line 63, in __iter__\n\tfor row in compiler.results_iter(results):\n File \"/home/sergey/dev/django/django/db/models/sql/compiler.py\", line 998, in apply_converters\n\tvalue = converter(value, expression, connection)\n File \"/home/sergey/dev/django/django/db/backends/base/operations.py\", line 571, in convert_durationfield_value\n\tvalue = str(decimal.Decimal(value) / decimal.Decimal(1000000))\ndecimal.InvalidOperation: [<class 'decimal.ConversionSyntax'>]\n",
  "ground_truth": {
    "files": [
      "django/db/models/expressions.py",
      "django/db/backends/base/operations.py",
      "django/db/backends/mysql/operations.py",
      "django/db/backends/sqlite3/operations.py"
    ],
    "locations": [
      "django/db/backends/base/operations.py::BaseDatabaseOperations",
      "django/db/backends/base/operations.py::BaseDatabaseOperations.date_extract_sql",
      "django/db/backends/base/operations.py::BaseDatabaseOperations.date_interval_sql",
      "django/db/backends/base/operations.py::BaseDatabaseOperations.date_trunc_sql",
      "django/db/backends/mysql/operations.py::DatabaseOperations",
      "django/db/backends/mysql/operations.py::DatabaseOperations.time_trunc_sql",
      "django/db/backends/mysql/operations.py::DatabaseOperations.date_interval_sql",
      "django/db/backends/mysql/operations.py::DatabaseOperations.fetch_returned_insert_rows",
      "django/db/backends/sqlite3/operations.py::DatabaseOperations",
      "django/db/backends/sqlite3/operations.py::DatabaseOperations.date_extract_sql",
      "django/db/backends/sqlite3/operations.py::DatabaseOperations.date_interval_sql",
      "django/db/backends/sqlite3/operations.py::DatabaseOperations.format_for_duration_arithmetic",
      "django/db/models/expressions.py::Combinable",
      "django/db/models/expressions.py::Combinable._combine",
      "django/db/models/expressions.py::CombinedExpression",
      "django/db/models/expressions.py::CombinedExpression.as_sql",
      "django/db/models/expressions.py::DurationExpression",
      "django/db/models/expressions.py::DurationExpression.compile",
      "django/db/models/expressions.py::DurationExpression.as_sql",
      "django/db/models/expressions.py::Value",
      "django/db/models/expressions.py::Value.get_group_by_cols",
      "django/db/models/expressions.py::DurationValue",
      "django/db/models/expressions.py::DurationValue.as_sql",
      "django/db/models/expressions.py::RawSQL",
      "django/db/models/expressions.py::RawSQL.__init__"
    ]
  },
  "predictions": [
    "django/db/models/expressions.py::DurationExpression.compile",
    "django/db/models/expressions.py::DurationExpression.as_sql",
    "django/db/models/expressions.py::DurationValue.as_sql",
    "tests/expressions/tests.py::FTimeDeltaTests.test_duration_with_datetime",
    "tests/expressions/tests.py::FTimeDeltaTests.test_durationfield_add",
    "tests/expressions/models.py::Experiment.duration",
    "tests/expressions/tests.py::FTimeDeltaTests.setUpTestData",
    "django/db/models/expressions.py::CombinedExpression.as_sql",
    "tests/expressions_case/tests.py::CaseExpressionTests.test_update_duration",
    "tests/expressions/tests.py::FTimeDeltaTests.test_duration_with_datetime_microseconds"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "ec5aa2161d8015a3fe57dcbbfe14200cd18f0a16",
    "total_functions_indexed": 23654,
    "retrieval_time_seconds": 0.007761955261230469
  },
  "raw_output": "[{\"doc_id\": \"django/db/models/expressions.py::DurationExpression.compile\", \"score\": 0.5739710927009583}, {\"doc_id\": \"django/db/models/expressions.py::DurationExpression.as_sql\", \"score\": 0.5650161504745483}, {\"doc_id\": \"django/db/models/expressions.py::DurationValue.as_sql\", \"score\": 0.5347641706466675}, {\"doc_id\": \"tests/expressions/tests.py::FTimeDeltaTests.test_duration_with_datetime\", \"score\": 0.5195720195770264}, {\"doc_id\": \"tests/expressions/tests.py::FTimeDeltaTests.test_durationfield_add\", \"score\": 0.5120998620986938}, {\"doc_id\": \"tests/expressions/models.py::Experiment.duration\", \"score\": 0.48389333486557007}, {\"doc_id\": \"tests/expressions/tests.py::FTimeDeltaTests.setUpTestData\", \"score\": 0.48254919052124023}, {\"doc_id\": \"django/db/models/expressions.py::CombinedExpression.as_sql\", \"score\": 0.48141583800315857}, {\"doc_id\": \"tests/expressions_case/tests.py::CaseExpressionTests.test_update_duration\", \"score\": 0.4808063805103302}, {\"doc_id\": \"tests/expressions/tests.py::FTimeDeltaTests.test_duration_with_datetime_microseconds\", \"score\": 0.4691169857978821}]"
}