{
  "instance_id": "pytest-dev__pytest-7571",
  "query": "caplog fixture doesn't restore log level after test\nFrom the documentation at https://docs.pytest.org/en/6.0.0/logging.html#caplog-fixture, \"The log levels set are restored automatically at the end of the test\".\r\nIt used to work, but looks broken in new 6.0 release. Minimal example to reproduce:\r\n\r\n```\r\ndef test_foo(caplog):\r\n    caplog.set_level(42)\r\n\r\ndef test_bar(caplog):\r\n    print(caplog.handler.level)\r\n```\r\n\r\nIt prints \"0\" for pytest<6, \"42\" after.\n",
  "ground_truth": {
    "files": [
      "src/_pytest/logging.py"
    ],
    "locations": [
      "src/_pytest/logging.py::LogCaptureFixture",
      "src/_pytest/logging.py::LogCaptureFixture.__init__",
      "src/_pytest/logging.py::LogCaptureFixture._finalize",
      "src/_pytest/logging.py::LogCaptureFixture.set_level"
    ]
  },
  "predictions": [
    "testing/logging/test_fixture.py::test_change_level",
    "testing/logging/test_fixture.py::test_change_level_undo",
    "testing/logging/test_fixture.py::test_caplog_can_override_global_log_level",
    "src/_pytest/logging.py::LogCaptureFixture.set_level",
    "src/_pytest/logging.py::LogCaptureFixture._finalize",
    "testing/logging/test_fixture.py::test_log_access",
    "testing/logging/test_fixture.py::test_caplog_captures_for_all_stages",
    "testing/logging/test_fixture.py::logging_during_setup_and_teardown",
    "src/_pytest/logging.py::LogCaptureFixture.at_level",
    "testing/logging/test_fixture.py::test_with_statement"
  ],
  "metadata": {
    "repo": "pytest-dev/pytest",
    "commit": "422685d0bdc110547535036c1ff398b5e1c44145",
    "total_functions_indexed": 3917,
    "retrieval_time_seconds": 0.007879257202148438
  },
  "raw_output": "[{\"doc_id\": \"testing/logging/test_fixture.py::test_change_level\", \"score\": 0.6505008935928345}, {\"doc_id\": \"testing/logging/test_fixture.py::test_change_level_undo\", \"score\": 0.5933671593666077}, {\"doc_id\": \"testing/logging/test_fixture.py::test_caplog_can_override_global_log_level\", \"score\": 0.5897351503372192}, {\"doc_id\": \"src/_pytest/logging.py::LogCaptureFixture.set_level\", \"score\": 0.5897282361984253}, {\"doc_id\": \"src/_pytest/logging.py::LogCaptureFixture._finalize\", \"score\": 0.5760778188705444}, {\"doc_id\": \"testing/logging/test_fixture.py::test_log_access\", \"score\": 0.523234486579895}, {\"doc_id\": \"testing/logging/test_fixture.py::test_caplog_captures_for_all_stages\", \"score\": 0.5170552730560303}, {\"doc_id\": \"testing/logging/test_fixture.py::logging_during_setup_and_teardown\", \"score\": 0.5089608430862427}, {\"doc_id\": \"src/_pytest/logging.py::LogCaptureFixture.at_level\", \"score\": 0.5041466355323792}, {\"doc_id\": \"testing/logging/test_fixture.py::test_with_statement\", \"score\": 0.49856677651405334}]"
}