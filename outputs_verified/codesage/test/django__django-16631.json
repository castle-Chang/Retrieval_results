{
  "instance_id": "django__django-16631",
  "query": "SECRET_KEY_FALLBACKS is not used for sessions\nDescription\n\t\nI recently rotated my secret key, made the old one available in SECRET_KEY_FALLBACKS and I'm pretty sure everyone on our site is logged out now.\nI think the docs for ​SECRET_KEY_FALLBACKS may be incorrect when stating the following:\nIn order to rotate your secret keys, set a new SECRET_KEY and move the previous value to the beginning of SECRET_KEY_FALLBACKS. Then remove the old values from the end of the SECRET_KEY_FALLBACKS when you are ready to expire the sessions, password reset tokens, and so on, that make use of them.\nWhen looking at the Django source code, I see that the ​salted_hmac function uses the SECRET_KEY by default and the ​AbstractBaseUser.get_session_auth_hash method does not call salted_hmac with a value for the secret keyword argument.\n",
  "ground_truth": {
    "files": [
      "django/contrib/auth/base_user.py",
      "django/contrib/auth/__init__.py"
    ],
    "locations": [
      "django/contrib/auth/__init__.py::get_user",
      "django/contrib/auth/base_user.py::AbstractBaseUser",
      "django/contrib/auth/base_user.py::AbstractBaseUser.get_session_auth_hash"
    ]
  },
  "predictions": [
    "django/contrib/auth/base_user.py::AbstractBaseUser.get_session_auth_hash",
    "django/contrib/auth/__init__.py::update_session_auth_hash",
    "django/contrib/auth/tokens.py::PasswordResetTokenGenerator._get_fallbacks",
    "django/contrib/auth/tokens.py::PasswordResetTokenGenerator._make_hash_value",
    "django/utils/crypto.py::salted_hmac",
    "django/contrib/sessions/backends/base.py::SessionBase.key_salt",
    "tests/auth_tests/test_views.py::SessionAuthenticationTests.test_user_password_change_updates_session",
    "django/contrib/auth/hashers.py::UnsaltedSHA1PasswordHasher.salt",
    "tests/utils_tests/test_crypto.py::TestUtilsCryptoMisc.test_salted_hmac",
    "django/contrib/sessions/backends/base.py::SessionBase._get_new_session_key"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "9b224579875e30203d079cc2fee83b116d98eb78",
    "total_functions_indexed": 26453,
    "retrieval_time_seconds": 0.009252071380615234
  },
  "raw_output": "[{\"doc_id\": \"django/contrib/auth/base_user.py::AbstractBaseUser.get_session_auth_hash\", \"score\": 0.4475935697555542}, {\"doc_id\": \"django/contrib/auth/__init__.py::update_session_auth_hash\", \"score\": 0.42510125041007996}, {\"doc_id\": \"django/contrib/auth/tokens.py::PasswordResetTokenGenerator._get_fallbacks\", \"score\": 0.4043753147125244}, {\"doc_id\": \"django/contrib/auth/tokens.py::PasswordResetTokenGenerator._make_hash_value\", \"score\": 0.38860780000686646}, {\"doc_id\": \"django/utils/crypto.py::salted_hmac\", \"score\": 0.38456064462661743}, {\"doc_id\": \"django/contrib/sessions/backends/base.py::SessionBase.key_salt\", \"score\": 0.36369645595550537}, {\"doc_id\": \"tests/auth_tests/test_views.py::SessionAuthenticationTests.test_user_password_change_updates_session\", \"score\": 0.36031562089920044}, {\"doc_id\": \"django/contrib/auth/hashers.py::UnsaltedSHA1PasswordHasher.salt\", \"score\": 0.35407042503356934}, {\"doc_id\": \"tests/utils_tests/test_crypto.py::TestUtilsCryptoMisc.test_salted_hmac\", \"score\": 0.35215404629707336}, {\"doc_id\": \"django/contrib/sessions/backends/base.py::SessionBase._get_new_session_key\", \"score\": 0.347038209438324}]"
}