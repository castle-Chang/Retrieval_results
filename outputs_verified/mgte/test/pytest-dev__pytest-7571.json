{
  "instance_id": "pytest-dev__pytest-7571",
  "query": "caplog fixture doesn't restore log level after test\nFrom the documentation at https://docs.pytest.org/en/6.0.0/logging.html#caplog-fixture, \"The log levels set are restored automatically at the end of the test\".\r\nIt used to work, but looks broken in new 6.0 release. Minimal example to reproduce:\r\n\r\n```\r\ndef test_foo(caplog):\r\n    caplog.set_level(42)\r\n\r\ndef test_bar(caplog):\r\n    print(caplog.handler.level)\r\n```\r\n\r\nIt prints \"0\" for pytest<6, \"42\" after.\n",
  "ground_truth": {
    "files": [
      "src/_pytest/logging.py"
    ],
    "locations": [
      "src/_pytest/logging.py::LogCaptureFixture",
      "src/_pytest/logging.py::LogCaptureFixture.__init__",
      "src/_pytest/logging.py::LogCaptureFixture._finalize",
      "src/_pytest/logging.py::LogCaptureFixture.set_level"
    ]
  },
  "predictions": [
    "testing/logging/test_fixture.py::test_change_level_undo",
    "testing/logging/test_fixture.py::test_caplog_can_override_global_log_level",
    "testing/logging/test_fixture.py::test_change_level",
    "src/_pytest/logging.py::LogCaptureFixture._finalize",
    "testing/logging/test_fixture.py::test_caplog_captures_despite_exception",
    "src/_pytest/logging.py::LogCaptureFixture.set_level",
    "testing/logging/test_fixture.py::test_fixture_help",
    "testing/logging/test_fixture.py::test_log_report_captures_according_to_config_option_upon_failure",
    "testing/logging/test_fixture.py::test_clear",
    "testing/logging/test_fixture.py::test_log_access"
  ],
  "metadata": {
    "repo": "pytest-dev/pytest",
    "commit": "422685d0bdc110547535036c1ff398b5e1c44145",
    "total_functions_indexed": 3917,
    "retrieval_time_seconds": 0.001148223876953125
  },
  "raw_output": "[{\"doc_id\": \"testing/logging/test_fixture.py::test_change_level_undo\", \"score\": 0.8084504008293152}, {\"doc_id\": \"testing/logging/test_fixture.py::test_caplog_can_override_global_log_level\", \"score\": 0.8005142211914062}, {\"doc_id\": \"testing/logging/test_fixture.py::test_change_level\", \"score\": 0.7900287508964539}, {\"doc_id\": \"src/_pytest/logging.py::LogCaptureFixture._finalize\", \"score\": 0.7824744582176208}, {\"doc_id\": \"testing/logging/test_fixture.py::test_caplog_captures_despite_exception\", \"score\": 0.7823256254196167}, {\"doc_id\": \"src/_pytest/logging.py::LogCaptureFixture.set_level\", \"score\": 0.7687403559684753}, {\"doc_id\": \"testing/logging/test_fixture.py::test_fixture_help\", \"score\": 0.7655011415481567}, {\"doc_id\": \"testing/logging/test_fixture.py::test_log_report_captures_according_to_config_option_upon_failure\", \"score\": 0.7618283629417419}, {\"doc_id\": \"testing/logging/test_fixture.py::test_clear\", \"score\": 0.7581759691238403}, {\"doc_id\": \"testing/logging/test_fixture.py::test_log_access\", \"score\": 0.7573787569999695}]"
}