{
  "instance_id": "django__django-16612",
  "query": "AdminSite.catch_all_view() drops query string in redirects\nDescription\n\t\n#31747 introduced AdminSite.catch_all_view(). However, in the process it broke the ability to redirect with settings.APPEND_SLASH = True when there are query strings.\nProvided URL: ​http://127.0.0.1:8000/admin/auth/foo?id=123\nExpected redirect: ​http://127.0.0.1:8000/admin/auth/foo/?id=123\nActual redirect: ​http://127.0.0.1:8000/admin/auth/foo/\nThis seems to be because the redirect in question does not include the query strings (such as via request.META['QUERY_STRING']):\nreturn HttpResponsePermanentRedirect(\"%s/\" % request.path)\n​https://github.com/django/django/blob/c57ff9ba5e251cd4c2761105a6046662c08f951e/django/contrib/admin/sites.py#L456\n",
  "ground_truth": {
    "files": [
      "django/contrib/admin/sites.py"
    ],
    "locations": [
      "django/contrib/admin/sites.py::AdminSite",
      "django/contrib/admin/sites.py::AdminSite.catch_all_view",
      "django/contrib/admin/sites.py::AdminSite._build_app_dict"
    ]
  },
  "predictions": [
    "django/contrib/admin/sites.py::AdminSite.catch_all_view",
    "tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_known_url_missing_slash_redirects_with_slash_if_not_auth_no_catch_all_view",
    "tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_non_admin_url_shares_url_prefix_without_final_catch_all_view",
    "django/views/generic/base.py::RedirectView.get",
    "tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_missing_slash_append_slash_true_without_final_catch_all_view",
    "tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_known_url_redirects_login_if_not_auth_without_final_catch_all_view",
    "tests/test_client/views.py::double_redirect_view",
    "tests/test_client/views.py::method_saving_307_redirect_query_string_view",
    "tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_unknown_url_no_trailing_slash_if_not_auth_without_final_catch_all_view",
    "tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_known_url_missing_slash_redirects_login_if_not_authenticated"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "55bcbd8d172b689811fae17cde2f09218dd74e9c",
    "total_functions_indexed": 26417,
    "retrieval_time_seconds": 0.006892204284667969
  },
  "raw_output": "[{\"doc_id\": \"django/contrib/admin/sites.py::AdminSite.catch_all_view\", \"score\": 0.8473074436187744}, {\"doc_id\": \"tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_known_url_missing_slash_redirects_with_slash_if_not_auth_no_catch_all_view\", \"score\": 0.7910007238388062}, {\"doc_id\": \"tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_non_admin_url_shares_url_prefix_without_final_catch_all_view\", \"score\": 0.785554826259613}, {\"doc_id\": \"django/views/generic/base.py::RedirectView.get\", \"score\": 0.7781740427017212}, {\"doc_id\": \"tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_missing_slash_append_slash_true_without_final_catch_all_view\", \"score\": 0.7767651081085205}, {\"doc_id\": \"tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_known_url_redirects_login_if_not_auth_without_final_catch_all_view\", \"score\": 0.7716557383537292}, {\"doc_id\": \"tests/test_client/views.py::double_redirect_view\", \"score\": 0.759682834148407}, {\"doc_id\": \"tests/test_client/views.py::method_saving_307_redirect_query_string_view\", \"score\": 0.7542017698287964}, {\"doc_id\": \"tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_unknown_url_no_trailing_slash_if_not_auth_without_final_catch_all_view\", \"score\": 0.7532873749732971}, {\"doc_id\": \"tests/admin_views/tests.py::AdminSiteFinalCatchAllPatternTests.test_known_url_missing_slash_redirects_login_if_not_authenticated\", \"score\": 0.7525392770767212}]"
}