{
  "instance_id": "matplotlib__matplotlib-25311",
  "query": "[Bug]: Unable to pickle figure with draggable legend\n### Bug summary\r\n\r\nI am unable to pickle figure with draggable legend. Same error comes for draggable annotations.\r\n\r\n\r\n\r\n\r\n\r\n### Code for reproduction\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport pickle\r\n\r\nfig = plt.figure()\r\nax = fig.add_subplot(111)\r\n\r\ntime=[0,1,2,3,4]\r\nspeed=[40,43,45,47,48]\r\n\r\nax.plot(time,speed,label=\"speed\")\r\n\r\nleg=ax.legend()\r\nleg.set_draggable(True) #pickling works after removing this line \r\n\r\npickle.dumps(fig)\r\nplt.show()\r\n```\r\n\r\n\r\n### Actual outcome\r\n\r\n`TypeError: cannot pickle 'FigureCanvasQTAgg' object`\r\n\r\n### Expected outcome\r\n\r\nPickling successful\r\n\r\n### Additional information\r\n\r\n_No response_\r\n\r\n### Operating system\r\n\r\nWindows 10\r\n\r\n### Matplotlib Version\r\n\r\n3.7.0\r\n\r\n### Matplotlib Backend\r\n\r\n_No response_\r\n\r\n### Python version\r\n\r\n3.10\r\n\r\n### Jupyter version\r\n\r\n_No response_\r\n\r\n### Installation\r\n\r\npip\n",
  "ground_truth": {
    "files": [
      "lib/matplotlib/offsetbox.py"
    ],
    "locations": [
      "lib/matplotlib/offsetbox.py::DraggableBase",
      "lib/matplotlib/offsetbox.py::DraggableBase.__init__",
      "lib/matplotlib/offsetbox.py::DraggableBase.on_motion"
    ]
  },
  "predictions": [
    "lib/matplotlib/legend.py::Legend.get_draggable",
    "lib/matplotlib/legend.py::Legend.set_draggable",
    "lib/matplotlib/tests/test_legend.py::test_legend_draggable",
    "galleries/examples/event_handling/legend_picking.py::on_pick",
    "lib/matplotlib/tests/test_pickle.py::test_no_pyplot",
    "lib/matplotlib/legend.py::DraggableLegend.__init__",
    "lib/matplotlib/tests/test_legend.py::test_get_set_draggable",
    "lib/matplotlib/tests/test_pickle.py::test_unpickle_canvas",
    "lib/matplotlib/artist.py::Artist.pickable",
    "lib/matplotlib/backend_bases.py::FigureCanvasBase.pick_event"
  ],
  "metadata": {
    "repo": "matplotlib/matplotlib",
    "commit": "430fb1db88843300fb4baae3edc499bbfe073b0c",
    "total_functions_indexed": 9188,
    "retrieval_time_seconds": 0.0019083023071289062
  },
  "raw_output": "[{\"doc_id\": \"lib/matplotlib/legend.py::Legend.get_draggable\", \"score\": 0.749186635017395}, {\"doc_id\": \"lib/matplotlib/legend.py::Legend.set_draggable\", \"score\": 0.7478759288787842}, {\"doc_id\": \"lib/matplotlib/tests/test_legend.py::test_legend_draggable\", \"score\": 0.7459204196929932}, {\"doc_id\": \"galleries/examples/event_handling/legend_picking.py::on_pick\", \"score\": 0.7418748736381531}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_no_pyplot\", \"score\": 0.7380296587944031}, {\"doc_id\": \"lib/matplotlib/legend.py::DraggableLegend.__init__\", \"score\": 0.7355012893676758}, {\"doc_id\": \"lib/matplotlib/tests/test_legend.py::test_get_set_draggable\", \"score\": 0.729772686958313}, {\"doc_id\": \"lib/matplotlib/tests/test_pickle.py::test_unpickle_canvas\", \"score\": 0.7261409759521484}, {\"doc_id\": \"lib/matplotlib/artist.py::Artist.pickable\", \"score\": 0.724205732345581}, {\"doc_id\": \"lib/matplotlib/backend_bases.py::FigureCanvasBase.pick_event\", \"score\": 0.7184157371520996}]"
}