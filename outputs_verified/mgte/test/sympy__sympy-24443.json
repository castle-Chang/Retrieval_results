{
  "instance_id": "sympy__sympy-24443",
  "query": "`_check_homomorphism` is broken on PermutationGroups\n```python\r\nIn [1]: from sympy.combinatorics import *\r\n   ...: from sympy.combinatorics.homomorphisms import homomorphism\r\n   ...: D3 = DihedralGroup(3)\r\n   ...: T = homomorphism(D3, D3, D3.generators, D3.generators)\r\n\r\nValueError: The given images do not define a homomorphism\r\n```\r\n\r\nThe issue is in the internal `_image()` function, where it handles the case of a `PermutationGroup`:\r\n\r\nhttps://github.com/sympy/sympy/blob/809c53c077485ca48a206cee78340389cb83b7f1/sympy/combinatorics/homomorphisms.py#L336-L337\r\n\r\nWhen `r[i]` is an inverted generator, the `in gens` test fails.\r\n\r\nI think the whole thing can be greatly simplified.\n",
  "ground_truth": {
    "files": [
      "sympy/combinatorics/homomorphisms.py"
    ],
    "locations": [
      "sympy/combinatorics/homomorphisms.py::homomorphism",
      "sympy/combinatorics/homomorphisms.py::_check_homomorphism"
    ]
  },
  "predictions": [
    "sympy/combinatorics/homomorphisms.py::_check_homomorphism",
    "sympy/combinatorics/homomorphisms.py::homomorphism",
    "sympy/combinatorics/homomorphisms.py::GroupHomomorphism.invert_subgroup",
    "sympy/combinatorics/homomorphisms.py::GroupHomomorphism._invs",
    "sympy/combinatorics/tests/test_homomorphisms.py::test_check_homomorphism",
    "sympy/combinatorics/homomorphisms.py::GroupHomomorphism.restrict_to",
    "sympy/combinatorics/perm_groups.py::PermutationGroup.__contains__",
    "sympy/combinatorics/homomorphisms.py::GroupHomomorphism.invert",
    "sympy/combinatorics/homomorphisms.py::GroupHomomorphism.image",
    "sympy/combinatorics/homomorphisms.py::GroupHomomorphism.is_trivial"
  ],
  "metadata": {
    "repo": "sympy/sympy",
    "commit": "809c53c077485ca48a206cee78340389cb83b7f1",
    "total_functions_indexed": 29994,
    "retrieval_time_seconds": 0.006562948226928711
  },
  "raw_output": "[{\"doc_id\": \"sympy/combinatorics/homomorphisms.py::_check_homomorphism\", \"score\": 0.8038060665130615}, {\"doc_id\": \"sympy/combinatorics/homomorphisms.py::homomorphism\", \"score\": 0.7963539361953735}, {\"doc_id\": \"sympy/combinatorics/homomorphisms.py::GroupHomomorphism.invert_subgroup\", \"score\": 0.7906272411346436}, {\"doc_id\": \"sympy/combinatorics/homomorphisms.py::GroupHomomorphism._invs\", \"score\": 0.7744770050048828}, {\"doc_id\": \"sympy/combinatorics/tests/test_homomorphisms.py::test_check_homomorphism\", \"score\": 0.7731240391731262}, {\"doc_id\": \"sympy/combinatorics/homomorphisms.py::GroupHomomorphism.restrict_to\", \"score\": 0.7675057649612427}, {\"doc_id\": \"sympy/combinatorics/perm_groups.py::PermutationGroup.__contains__\", \"score\": 0.7610775232315063}, {\"doc_id\": \"sympy/combinatorics/homomorphisms.py::GroupHomomorphism.invert\", \"score\": 0.7556639909744263}, {\"doc_id\": \"sympy/combinatorics/homomorphisms.py::GroupHomomorphism.image\", \"score\": 0.7552251815795898}, {\"doc_id\": \"sympy/combinatorics/homomorphisms.py::GroupHomomorphism.is_trivial\", \"score\": 0.7521916627883911}]"
}