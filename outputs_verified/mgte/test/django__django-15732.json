{
  "instance_id": "django__django-15732",
  "query": "Cannot drop unique_together constraint on a single field with its own unique=True constraint\nDescription\n\t\nI have an erroneous unique_together constraint on a model's primary key (unique_together = (('id',),)) that cannot be dropped by a migration. Apparently the migration tries to find all unique constraints on the column and expects there to be only one, but I've got two â€” the primary key and the unique_together constraint:\nIndexes:\n\t\"foo_bar_pkey\" PRIMARY KEY, btree (id)\n\t\"foo_bar_id_1c3b3088c74c3b17_uniq\" UNIQUE CONSTRAINT, btree (id)\nDatabase is PostgreSQL, if that makes any difference.\n",
  "ground_truth": {
    "files": [
      "django/db/backends/base/schema.py"
    ],
    "locations": [
      "django/db/backends/base/schema.py::BaseDatabaseSchemaEditor",
      "django/db/backends/base/schema.py::BaseDatabaseSchemaEditor.alter_unique_together",
      "django/db/backends/base/schema.py::BaseDatabaseSchemaEditor._delete_composed_index",
      "django/db/backends/base/schema.py::BaseDatabaseSchemaEditor._create_unique_sql",
      "django/db/backends/base/schema.py::BaseDatabaseSchemaEditor._delete_unique_sql"
    ]
  },
  "predictions": [
    "django/db/backends/base/schema.py::BaseDatabaseSchemaEditor.alter_unique_together",
    "tests/schema/tests.py::SchemaTests.test_remove_unique_together_does_not_remove_meta_constraints",
    "django/db/migrations/operations/models.py::AlterUniqueTogether.__init__",
    "django/db/models/base.py::Model._check_unique_together",
    "tests/schema/tests.py::SchemaTests.test_unique_together_with_fk_with_existing_index",
    "tests/migrations/test_operations.py::OperationTests.test_alter_unique_together_remove",
    "tests/migrations/test_autodetector.py::AutodetectorTests.test_remove_field_and_foo_together",
    "tests/migrations/test_autodetector.py::AutodetectorTests.test_foo_together_remove_fk",
    "tests/schema/tests.py::SchemaTests.test_unique_together_with_fk",
    "tests/schema/tests.py::SchemaTests.test_unique_together"
  ],
  "metadata": {
    "repo": "django/django",
    "commit": "ce69e34bd646558bb44ea92cecfd98b345a0b3e0",
    "total_functions_indexed": 25969,
    "retrieval_time_seconds": 0.00785064697265625
  },
  "raw_output": "[{\"doc_id\": \"django/db/backends/base/schema.py::BaseDatabaseSchemaEditor.alter_unique_together\", \"score\": 0.7162377834320068}, {\"doc_id\": \"tests/schema/tests.py::SchemaTests.test_remove_unique_together_does_not_remove_meta_constraints\", \"score\": 0.7140603065490723}, {\"doc_id\": \"django/db/migrations/operations/models.py::AlterUniqueTogether.__init__\", \"score\": 0.699097752571106}, {\"doc_id\": \"django/db/models/base.py::Model._check_unique_together\", \"score\": 0.6943328380584717}, {\"doc_id\": \"tests/schema/tests.py::SchemaTests.test_unique_together_with_fk_with_existing_index\", \"score\": 0.6854000687599182}, {\"doc_id\": \"tests/migrations/test_operations.py::OperationTests.test_alter_unique_together_remove\", \"score\": 0.6808968186378479}, {\"doc_id\": \"tests/migrations/test_autodetector.py::AutodetectorTests.test_remove_field_and_foo_together\", \"score\": 0.6790875196456909}, {\"doc_id\": \"tests/migrations/test_autodetector.py::AutodetectorTests.test_foo_together_remove_fk\", \"score\": 0.6773576736450195}, {\"doc_id\": \"tests/schema/tests.py::SchemaTests.test_unique_together_with_fk\", \"score\": 0.6749775409698486}, {\"doc_id\": \"tests/schema/tests.py::SchemaTests.test_unique_together\", \"score\": 0.6744770407676697}]"
}